const chidanchuong1 = document.getElementById("chuong1");
const suachuong2 = document.getElementById("suachuong2");
const xemchuong2 = document.getElementById("xemchuong2");
const suachuong3 = document.getElementById("suachuong3");
const xemchuong3 = document.getElementById("xemchuong3");
//const chinhsuabieumaumoithau = document.getElementById('suabieumaumoithau');
//const bieumaumoithau = document.getElementById('bieumaumoithau');
const suachuong4 = document.getElementById("suabieumaumoithau");
const xemchuong4 = document.getElementById("bieumaumoithau");
const xemchuong5 = document.getElementById("xemchuong5");
const xemchuong6 = document.getElementById("xemchuong6");
const suachuong7 = document.getElementById("suachuong7");
const xemchuong7 = document.getElementById("xemchuong7");
const suachuong8 = document.getElementById("suachuong8");
const xemchuong8 = document.getElementById("xemchuong8");

const mucso1 = document.getElementById("muc1");
const mucso21 = document.getElementById("muc21");
const mucso22a = document.getElementById("muc22a");
const mucso22b = document.getElementById("muc22b");
const mucso3 = document.getElementById("muc3");
const mucso4 = document.getElementById("muc4");

const suamuc1 = document.getElementById("suamuc1");
const suamuc21 = document.getElementById("suamuc21");
const suamuc22 = document.getElementById("suamuc22");
const suamuc22a = document.getElementById("suamuc22a");
const suamuc22b = document.getElementById("suamuc22b");
const suamuc3 = document.getElementById("suamuc3");
const suamuc4 = document.getElementById("suamuc4");

const suamuc1A = document.getElementById("suamuc1A");
const suamuc1E = document.getElementById("suamuc1E");
const muc1A = document.getElementById("muc1A");
const muc1E = document.getElementById("muc1E");

const mau13 = document.getElementById("mauso13");
const mau14 = document.getElementById("mauso14");
const mau15 = document.getElementById("mauso15");
const mau16 = document.getElementById("mauso16");
const mau17 = document.getElementById("mauso17");

const xemmau13 = document.getElementById("xemmauso13");
const xemmau14 = document.getElementById("xemmauso14");
const xemmau15 = document.getElementById("xemmauso15");
const xemmau16 = document.getElementById("xemmauso16");
const xemmau17 = document.getElementById("xemmauso17");

const suabangsomot = document.getElementById("suabangsomot");
const suabangsohai = document.getElementById("suabangsohai");
const xembangsomot = document.getElementById("xembangsomot");
const xembangsohai = document.getElementById("xembangsohai");

const dd21dongtien = document.getElementById("DD21dongtien");
const dd21b1check1 = document.getElementById("DD21B1check1");
const dd21b1check2 = document.getElementById("DD21B1check2");
const dd21b1check3 = document.getElementById("DD21B1check3");
const dd21b1check4 = document.getElementById("DD21B1check4");
const dd21b1check5 = document.getElementById("DD21B1check5");
const dd21b1sonam = document.getElementById("DD21B1sonam");
const dd21b1sotien = document.getElementById("DD21B1sotien");
const dd21b1lichsu = document.getElementById("DD21B1lichsu");
const dd21b1nhathau = document.getElementById("DD21B1nhathau");
const dd21b1tuongtu = document.getElementById("DD21B1tuongtu");
const dd21b1toithieu = document.getElementById("DD21B1toithieu");
const dd21b2check1 = document.getElementById("DD21B2check1");
const dd21b2check2 = document.getElementById("DD21B2check2");
const dd21b2check3 = document.getElementById("DD21B2check3");
const dd21b2check4 = document.getElementById("DD21B2check4");
const dd21b2check5 = document.getElementById("DD21B2check5");
const dd21b2doanhthu = document.getElementById("DD21B2doanhthu");
const dd21b2congsuat = document.getElementById("DD21B2congsuat");
const dd21b2sanluong = document.getElementById("DD21B2sanluong");

const dd22nhansucheck = document.getElementById("DD22nhansucheck");
const dd22nhansunocheck = document.getElementById("DD22nhansunocheck");
const dd22themmoi = document.getElementById("DD22themmoi");
const dd22table = document.getElementById("DD22table");
const dd22file = document.getElementById("DD22File");

const dd3dat = document.getElementById("DD3dat");
const dd3chamdiem = document.getElementById("DD3chamdiem");
const dd3file = document.getElementById("DD3file");

const dd4giathapnhat = document.getElementById("DD4giathapnhat");
const dd4giadanhgia = document.getElementById("DD3giadanhgia");

const d21dongtien = document.getElementById("D21dongtien");
const d21b1check1 = document.getElementById("D21B1check1");
const d21b1check2 = document.getElementById("D21B1check2");
const d21b1check3 = document.getElementById("D21B1check3");
const d21b1check4 = document.getElementById("D21B1check4");
const d21b1check5 = document.getElementById("D21B1check5");
const d21b1sonam = document.getElementById("D21B1sonam");
const d21b1sotien = document.getElementById("D21B1sotien");
const d21b1lichsu = document.getElementById("D21B1lichsu");
const d21b1nhathau = document.getElementById("D21B1nhathau");
const d21b1tuongtu = document.getElementById("D21B1tuongtu");
const d21b1toithieu = document.getElementById("D21B1toithieu");
const d21b2check1 = document.getElementById("D21B2check1");
const d21b2check2 = document.getElementById("D21B2check2");
const d21b2check3 = document.getElementById("D21B2check3");
const d21b2check4 = document.getElementById("D21B2check4");
const d21b2check5 = document.getElementById("D21B2check5");
const d21b2doanhthu = document.getElementById("D21B2doanhthu");
const d21b2congsuat = document.getElementById("D21B2congsuat");
const d21b2sanluong = document.getElementById("D21B2sanluong");

const d22nhansucheck = document.getElementById("D22nhansucheck");
//const dd22nhansunocheck = document.getElementById('DD22nhansunocheck');
//const dd22themmoi = document.getElementById('DD22themmoi');
const d22table = document.getElementById("DD22table");
//const dd22file = document.getElementById('DD22File');

const d3dat = document.getElementById("D3dat");
//const dd3chamdiem = document.getElementById('DD3chamdiem');
const d3file = document.getElementById("D3file");

const d4giathapnhat = document.getElementById("D4giathapnhat");
//const dd4giadanhgia = document.getElementById('DD3giadanhgia');

const ed1athemmoi = document.getElementById("ED1Athemmoi");
const ed1atable = document.getElementById("ED1Atable");
const ed1afile = document.getElementById("ED1Afile");

const ed1dcheck = document.getElementById("ED1Dcheck");
const ed1dnocheck = document.getElementById("ED1Dnocheck");
const ed1dthemmoi = document.getElementById("ED1Dthemmoi");
const ed1dtable = document.getElementById("ED1Dtable");
const ed1dfile = document.getElementById("ED1Dfile");

const ed1echeck = document.getElementById("ED1Echeck");
const ed1enocheck = document.getElementById("ED1Enocheck");
const ed1ethemmoi = document.getElementById("ED1Ethemmoi");
const ed1etable = document.getElementById("ED1Etable");
const ed1efile = document.getElementById("ED1Efile");

const e1atable = document.getElementById("E1Atable");
const e1ddichvu = document.getElementById("E1Ddichvu");
const e1dtable = document.getElementById("E1Dtable");

const e1ephutung = document.getElementById("E1Ephutung");
const e1etable = document.getElementById("E1Etable");

const hd14hopdong = document.getElementById("HD14hopdong");
const hd14phuluc = document.getElementById("HD14phuluc");
const hd14hopdongname = document.getElementById("HD14hopdongname");
const hd14phulucname = document.getElementById("HD14phulucname");
const h14hopdong = document.getElementById("H14hopdong");
const h14phuluc = document.getElementById("H14phuluc");

const bottomchuong8 = document.getElementById("bottomchuong8");

var checking = 0;

var savechidan = {};
var chuong2data = {};
var chuong3data = {};
var chuong4data = {};
var chuong7data = {};
var datadialog = 0;

function displaychuong2(rt) {
  xemchuong2.showModal();
  chuong2data = JSON.parse(rt);
  //chuong2data = JSON.parse(chuong2data);
  var reg = chuong2data;

  document.getElementById("C11chudautu").value = reg["CD11chudautu"];
  document.getElementById("C12tengoithau").value = reg["CD12tengoithau"];
  document.getElementById("C12tendutoan").value = reg["CD12tendutoan"];
  document.getElementById("C3nguonvon").value = reg["CD3nguonvon"];
  document.getElementById("C51cchudautu").value = reg["CD51cchudautu"];
  document.getElementById("C51cdiachi").value = reg["CD51cdiachi"];
  document.getElementById("C51cbenmoithau").value = reg["CD51cbenmoithau"];
  document.getElementById("C51cdiachibmt").value = reg["CD51cdiachibmt"];

  let tb = reg["CD51table"];
  let id1, id2, id3, id4, id5;
  for (let i = 0; i < tb.length; i++) {
    id1 = "C51T" + String(i + 1) + "1";
    id2 = "C51T" + String(i + 1) + "2";
    id3 = "C51T" + String(i + 1) + "3";
    id4 = "C51T" + String(i + 1) + "4";
    id5 = "C51T" + String(i + 1) + "5";
    document.getElementById(id1).value = tb[i][0];
    if (tb[i][1] == "1") {
      document.getElementById(id2).checked = true;
    } else {
      document.getElementById(id2).checked = false;
    }
    if (tb[i][2] == "1") {
      document.getElementById(id3).checked = true;
    } else {
      document.getElementById(id3).checked = false;
    }

    document.getElementById(id4).value = tb[i][3];
    document.getElementById(id5).value = tb[i][4];
  }

  document.getElementById("C51gdieukiendoanhnghiep").value =
    reg["CD51gdieukiendoanhnghiep"];

  if (reg["CD76check"] == "1") {
    document.getElementById("C76check").checked = true;
    document.getElementById("C76nocheck").checked = false;
    document.getElementById("C76checkDisplay").style.display = "block";
  } else {
    document.getElementById("C76check").checked = false;
    document.getElementById("C76nocheck").checked = true;
    document.getElementById("C76checkDisplay").style.display = "none";
  }

  document.getElementById("C76checkthoigian").value = reg["C76checkthoigian"];
  document.getElementById("C76checkdiadiem").value = reg["C76checkdiadiem"];
  document.getElementById("C76checkdienthoai").value = reg["C76checkdienthoai"];

  if (reg["CD77check"] == "1") {
    document.getElementById("C77check").checked = true;
    document.getElementById("C77nocheck").checked = false;
    document.getElementById("C77checkDisplay").style.display = "block";
  } else {
    document.getElementById("C77check").checked = false;
    document.getElementById("C77nocheck").checked = true;
    document.getElementById("C77checkDisplay").style.display = "none";
  }

  document.getElementById("C77checkthoigian").value = reg["CD77checkthoigian"];
  document.getElementById("C77checkdiadiem").value = reg["CD77checkdiadiem"];
  document.getElementById("C77checkdienthoai").value =
    reg["CD77checkdienthoai"];

  document.getElementById("C8chiphi").value = reg["CD8chiphi"];
  document.getElementById("C108tailieu").value = reg["CD108tailieu"];

  if (reg["CD121check"] == "1") {
    document.getElementById("C121check").checked = true;
    document.getElementById("C121check").checked = false;
    document.getElementById("C121checkDisplay").style.display = "block";
  } else {
    document.getElementById("C121nocheck").checked = false;
    document.getElementById("C121nocheck").checked = true;
    document.getElementById("C121checkDisplay").style.display = "none";
  }

  document.getElementById("C171thoihan").value = reg["CD171thoihan"];
  document.getElementById("C182giatri").value = reg["CD182giatri"];
  document.getElementById("C184thoigian").value = reg["CD184thoigian"];

  if (reg["CD275check"] == "1") {
    document.getElementById("C275check").value = reg["CD275check"];
    document.getElementById("C275nocheck").value = reg["CD275nocheck"];
  } else {
    document.getElementById("C275check").value = reg["CD275check"];
    document.getElementById("C275nocheck").value = reg["CD275nocheck"];
  }

  document.getElementById("C301nangluc").value = reg["CD301nangluc"];
  document.getElementById("C301kythuat").value = reg["CD301kythuat"];
  document.getElementById("C301taichinh").value = reg["CD301taichinh"];
  document.getElementById("C302xephangnhauthau").value =
    reg["CD302xephangnhauthau"];
  document.getElementById("C324").value = reg["CD324"];
  document.getElementById("C325giagoithau").value = reg["CD325giagoithau"];
  document.getElementById("C382thamquyen").value = reg["CD382thamquyen"];
  document.getElementById("C382diachi").value = reg["CD382diachi"];
  document.getElementById("C382email").value = reg["CD382email"];
  document.getElementById("C382diachithuongtruc").value =
    reg["CD382diachithuongtruc"];
  document.getElementById("C382emailgiupviec").value =
    reg["CD382emailgiupviec"];

  if (reg["CD39check"] == "1") {
    document.getElementById("C39check").checked = true;
    document.getElementById("C39nocheck").checked = false;
    document.getElementById("C39displayCheck").style.display = "block";
  } else {
    document.getElementById("C39check").checked = false;
    document.getElementById("C39nocheck").checked = true;
    document.getElementById("C39displayCheck").style.display = "none";
  }

  document.getElementById("C39ten").value = reg["CD39ten"];
  document.getElementById("C39diachi").value = reg["CD39diachi"];
  document.getElementById("C39dienthoai").value = reg["CD39dienthoai"];
  document.getElementById("C39fax").value = reg["CD39fax"];
}

function displayeditchuong2(rt) {
  chuong2data = JSON.parse(rt);
  //chuong2data = JSON.parse(chuong2data);
  var reg = chuong2data;

  document.getElementById("CD11chudautu").value = reg["CD11chudautu"];
  document.getElementById("CD12tengoithau").value = reg["CD12tengoithau"];
  document.getElementById("CD12tendutoan").value = reg["CD12tendutoan"];
  document.getElementById("CD3nguonvon").value = reg["CD3nguonvon"];
  document.getElementById("CD51cchudautu").value = reg["CD51cchudautu"];
  document.getElementById("CD51cdiachi").value = reg["CD51cdiachi"];
  document.getElementById("CD51cbenmoithau").value = reg["CD51cbenmoithau"];
  document.getElementById("CD51cdiachibmt").value = reg["CD51cdiachibmt"];

  let tb = reg["CD51table"];
  let id1, id2, id3, id4, id5;
  for (let i = 0; i < tb.length; i++) {
    id1 = "CD51T" + String(i + 1) + "1";
    id2 = "CD51T" + String(i + 1) + "2";
    id3 = "CD51T" + String(i + 1) + "3";
    id4 = "CD51T" + String(i + 1) + "4";
    id5 = "CD51T" + String(i + 1) + "5";
    document.getElementById(id1).value = tb[i][0];
    if (tb[i][1] == "1") {
      document.getElementById(id2).checked = true;
    } else {
      document.getElementById(id2).checked = false;
    }
    if (tb[i][2] == "1") {
      document.getElementById(id3).checked = true;
    } else {
      document.getElementById(id3).checked = false;
    }

    document.getElementById(id4).value = tb[i][3];
    document.getElementById(id5).value = tb[i][4];
  }

  document.getElementById("CD51gdieukiendoanhnghiep").value =
    reg["CD51gdieukiendoanhnghiep"];

  if (reg["CD76check"] == "1") {
    document.getElementById("CD76check").checked = true;
    document.getElementById("CD76nocheck").checked = false;
    document.getElementById("CD76checkDisplay").style.display = "block";
  } else {
    document.getElementById("CD76check").checked = false;
    document.getElementById("CD76nocheck").checked = true;
    document.getElementById("CD76checkDisplay").style.display = "none";
  }

  document.getElementById("CD76checkthoigian").value = reg["CD76checkthoigian"];
  document.getElementById("CD76checkdiadiem").value = reg["CD76checkdiadiem"];
  document.getElementById("CD76checkdienthoai").value =
    reg["CD76checkdienthoai"];

  if (reg["CD77check"] == "1") {
    document.getElementById("CD77check").checked = true;
    document.getElementById("CD77nocheck").checked = false;
    document.getElementById("CD77checkDisplay").style.display = "block";
  } else {
    document.getElementById("CD77check").checked = false;
    document.getElementById("CD77nocheck").checked = true;
    document.getElementById("CD77checkDisplay").style.display = "none";
  }

  document.getElementById("CD77checkthoigian").value = reg["CD77checkthoigian"];
  document.getElementById("CD77checkdiadiem").value = reg["CD77checkdiadiem"];
  document.getElementById("CD77checkdienthoai").value =
    reg["CD77checkdienthoai"];

  document.getElementById("CD8chiphi").value = reg["CD8chiphi"];
  document.getElementById("CD108tailieu").value = reg["CD108tailieu"];

  if (reg["CD121check"] == "1") {
    document.getElementById("CD121check").checked = true;
    document.getElementById("CD121check").checked = false;
    document.getElementById("CD121checkDisplay").style.display = "block";
  } else {
    document.getElementById("CD121check").checked = false;
    document.getElementById("CD121check").checked = true;
    document.getElementById("CD121checkDisplay").style.display = "none";
  }

  document.getElementById("CD121checkcongviec").value =
    reg["CD121checkcongviec"];

  document.getElementById("CD171thoihan").value = reg["CD171thoihan"];
  document.getElementById("CD182giatri").value = reg["CD182giatri"];
  document.getElementById("CD182thoigian").value = reg["CD182thoigian"];
  document.getElementById("CD184thoigian").value = reg["CD184thoigian"];

  if (reg["CD275check"] == "1") {
    document.getElementById("CD275check").checked = true;
    document.getElementById("CD275nocheck").checked = false;
  } else {
    document.getElementById("CD275check").checked = false;
    document.getElementById("CD275nocheck").checked = true;
  }

  document.getElementById("CD301nangluc").innerHTML = reg["CD301nangluc"];
  document.getElementById("CD301kythuat").innerHTML = reg["CD301kythuat"];
  document.getElementById("CD301taichinh").innerHTML = reg["CD301taichinh"];
  document.getElementById("CD302xephangnhathau").value =
    reg["CD302xephangnhathau"];
  document.getElementById("CD324").value = reg["CD324"];
  document.getElementById("CD325giagoithau").value = reg["CD325giagoithau"];
  document.getElementById("CD382thamquyen").value = reg["CD382thamquyen"];
  document.getElementById("CD382diachi").value = reg["CD382diachi"];
  document.getElementById("CD382email").value = reg["CD382email"];
  document.getElementById("CD382diachithuongtruc").value =
    reg["CD382diachithuongtruc"];
  document.getElementById("CD382emailgiupviec").value =
    reg["CD382emailgiupviec"];

  if (reg["cd39check"] == "1") {
    document.getElementById("CD39check").checked = true;
    document.getElementById("CD39nocheck").checked = false;
    document.getElementById("CD39checkDisplay").style.display = "block";
  } else {
    document.getElementById("CD39check").checked = false;
    document.getElementById("CD39nocheck").checked = true;
    document.getElementById("CD39checkDisplay").style.display = "none";
  }

  document.getElementById("CD39ten").value = reg["CD39ten"];
  document.getElementById("CD39diachi").value = reg["CD39diachi"];
  document.getElementById("CD39dienthoai").value = reg["CD39dienthoai"];
  document.getElementById("CD39fax").value = reg["CD39fax"];

  suachuong2.showModal();
}

function xemchidan() {
  chidanchuong1.showModal();
}
function dongchidan() {
  chidanchuong1.close();
}

function suadulieu() {
  document.getElementById("CD11chudautu").value = benmoithau.value;
  document.getElementById("CD12tengoithau").value = tengoithau.value;
  document.getElementById("CD12tendutoan").value = kehoachlcnt[10];
  document.getElementById("CD3nguonvon").value = nguonvon.value;
  document.getElementById("CD51cchudautu").value = benmoithau.value;

  var reg = {};
  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  suachuong2.showModal();
  // var xhr = new XMLHttpRequest();
  // xhr.open('POST', '/api/getehsmt/chuong2', true);
  // xhr.onreadystatechange = function () {
  //     if (xhr.readyState === 4) {
  //         if (xhr.status === 200) {
  //             //alert('Lấy chương 2 thành công!');
  //             let rt = this.responseText;
  //             if (rt.length < 10) {
  //                 suachuong2.showModal();
  //             //} else {
  //             //    displayeditchuong2(rt);
  //             }

  //             //rightButton.disabled = false;
  //         } else {
  //             alert('Lấy EHSMT chương 2 lỗi');
  //             //saveButton.disabled = false;
  //         }
  //     }
  // };
  // let st = JSON.stringify(reg);
  // xhr.send(st);
}
function dongsuadulieu() {
  suachuong2.close();
}
function xemdulieu() {
  var reg = {};
  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  var xhr = new XMLHttpRequest();
  xemchuong2.showModal();
  // xhr.open('POST', '/api/getehsmt/chuong2', true);
  // xhr.onreadystatechange = function () {
  //     if (xhr.readyState === 4) {
  //         if (xhr.status === 200) {
  //             //alert('Lấy chương 2 thành công!');
  //             let rt = this.responseText;
  //             if (rt.length < 10) {
  //                 alert('Mục này chưa ghi vào cơ sở dữ liệu hoặc đường truyền lỗi!');
  //             } else {
  //                 displaychuong2(rt);
  //             }

  //             //rightButton.disabled = false;
  //         } else {
  //             alert('Lấy EHSMT chương 2 lỗi');
  //             //saveButton.disabled = false;
  //         }
  //     }
  // };
  // let st = JSON.stringify(reg);
  // xhr.send(st);
}
function dongxemdulieu() {
  xemchuong2.close();
}

function handleCD77check() {
  if (document.getElementById("CD77check").checked == true) {
    document.getElementById("CD77checkDisplay").style.display = "block";
  } else {
    document.getElementById("CD77checkDisplay").style.display = "none";
  }
}

function handleCD76check() {
  if (document.getElementById("CD76check").checked == true) {
    document.getElementById("CD76checkDisplay").style.display = "block";
  } else {
    document.getElementById("CD76checkDisplay").style.display = "none";
  }
}

function handleCD121check() {
  if (document.getElementById("CD121check").checked == true) {
    document.getElementById("CD121checkDisplay").style.display = "block";
  } else {
    document.getElementById("CD121checkDisplay").style.display = "none";
  }
}

function handleCD39check() {
  if (document.getElementById("CD39check").checked == true) {
    document.getElementById("CD39checkDisplay").style.display = "block";
  } else {
    document.getElementById("CD39checkDisplay").style.display = "none";
  }
}

function displaychuong3(rt) {
  chuong3data = JSON.parse(rt);
  //chuong2data = JSON.parse(chuong2data);
  var reg = chuong3data;

  d21dongtien.value = reg["dd21dongtien"];

  if (reg["dd21b1check1"] == "1") {
    d21b1check1.checked = true;
  } else {
    d21b1check1.checked = false;
  }

  if (reg["dd21b1check2"] == "1") {
    d21b1check2.checked = true;
  } else {
    d21b1check2.checked = false;
  }
  if (reg["dd21b1check3"] == "1") {
    d21b1check3.checked = true;
  } else {
    d21b1check3.checked = false;
  }
  if (reg["dd21b1check4"] == "1") {
    d21b1check4.checked = true;
  } else {
    d21b1check4.checked = false;
  }
  if (reg["dd21b1check5"] == "1") {
    d21b1check5.checked = true;
  } else {
    d21b1check5.checked = false;
  }

  d21b1sonam.innerHTML = reg["dd21b1sonam"];
  d21b1sotien.innerHTML = reg["dd21b1sotien"];
  d21b1lichsu.innerHTML = reg["dd21b1lichsu"];
  d21b1nhathau.innerHTML = reg["dd21b1nhathau"];
  d21b1tuongtu.innerHTML = reg["dd21b1tuongtu"];
  d21b1toithieu.innerHTML = reg["dd21b1toithieu"];

  if (reg["dd21b2check1"] == "1") {
    d21b2check1.checked = true;
  } else {
    d21b2check1.checked = false;
  }

  if (reg["dd21b2check2"] == "1") {
    d21b2check2.checked = true;
  } else {
    d21b2check2.checked = false;
  }
  if (reg["dd21b2check3"] == "1") {
    d21b2check3.checked = true;
  } else {
    d21b2check3.checked = false;
  }
  if (reg["dd21b2check4"] == "1") {
    d21b2check4.checked = true;
  } else {
    d21b2check4.checked = false;
  }
  if (reg["dd21b2check5"] == "1") {
    d21b2check5.checked = true;
  } else {
    d21b2check5.checked = false;
  }

  d21b2doanhthu.innerHTML = reg["dd21b2doanhthu"];
  d21b2congsuat.innerHTML = reg["dd21b2congsuat"];
  d21b2sanluong.innerHTML = reg["dd21b2sanluong"];

  if (reg["dd22nhansucheck"] == "1") {
    d22nhansucheck.innerHTML = "Có";
  } else {
    d22nhansucheck.innerHTML = "Không";
  }

  // let tabdata = [];

  // var rowLength = dd22table.rows.length;

  // for (i = 0; i < rowLength; i++){

  //    var oCells = dd22table.rows.item(i).cells;

  //    //gets amount of cells of current row
  //    var cellLength = oCells.length;

  //    //loops through each cell in current row
  //    rowdata = [];
  //    for(var j = 0; j < cellLength; j++){
  //       // get your cell info here

  //       var cellVal = oCells.item(j).innerHTML;
  //       rowdata.push(cellVal);

  //    }
  //    tabdata.push(rowdata);
  // }

  // reg['dd22table'] = tabdata;

  //dd2file xu ly sau

  if (reg["dd3dat"] == "1") {
    d3dat.innerHTML = "Đạt/Không đạt";
  } else {
    d3dat.innerHTML = "Chấm điểm";
  }

  if (reg["dd4giathapnhat"] == "1") {
    d4giathapnhat.innerHTML = "Phương pháp giá thấp nhất";
  } else {
    d4giathapnhat.innerHTML = "Phương pháp giá đánh giá";
  }

  xemchuong3.showModal();
}

function displayeditchuong3(rt) {
  chuong3data = JSON.parse(rt);
  //chuong2data = JSON.parse(chuong2data);
  var reg = chuong3data;

  dd21dongtien.value = reg["dd21dongtien"];

  if (reg["dd21b1check1"] == "1") {
    dd21b1check1.checked = true;
  } else {
    dd21b1check1.checked = false;
  }

  if (reg["dd21b1check2"] == "1") {
    dd21b1check2.checked = true;
  } else {
    dd21b1check2.checked = false;
  }
  if (reg["dd21b1check3"] == "1") {
    dd21b1check3.checked = true;
  } else {
    dd21b1check3.checked = false;
  }
  if (reg["dd21b1check4"] == "1") {
    dd21b1check4.checked = true;
  } else {
    dd21b1check4.checked = false;
  }
  if (reg["dd21b1check5"] == "1") {
    dd21b1check5.checked = true;
  } else {
    dd21b1check5.checked = false;
  }

  dd21b1sonam.value = reg["dd21b1sonam"];
  dd21b1sotien.value = reg["dd21b1sotien"];
  dd21b1lichsu.value = reg["dd21b1lichsu"];
  dd21b1nhathau.value = reg["dd21b1nhathau"];
  dd21b1tuongtu.value = reg["dd21b1tuongtu"];
  dd21b1toithieu.value = reg["dd21b1toithieu"];

  if (reg["dd21b2check1"] == "1") {
    dd21b2check1.checked = true;
  } else {
    dd21b2check1.checked = false;
  }

  if (reg["dd21b2check2"] == "1") {
    dd21b2check2.checked = true;
  } else {
    dd21b2check2.checked = false;
  }
  if (reg["dd21b2check3"] == "1") {
    dd21b2check3.checked = true;
  } else {
    dd21b2check3.checked = false;
  }
  if (reg["dd21b2check4"] == "1") {
    dd21b2check4.checked = true;
  } else {
    dd21b2check4.checked = false;
  }
  if (reg["dd21b2check5"] == "1") {
    dd21b2check5.checked = true;
  } else {
    dd21b2check5.checked = false;
  }

  dd21b2doanhthu.value = reg["dd21b2doanhthu"];
  dd21b2congsuat.value = reg["dd21b2congsuat"];
  dd21b2sanluong.value = reg["dd21b2sanluong"];

  if (reg["dd22nhansucheck"] == "1") {
    dd22nhansucheck.checked = true;
  } else {
    dd22nhansucheck.checked = false;
  }

  // let tabdata = [];

  // var rowLength = dd22table.rows.length;

  // for (i = 0; i < rowLength; i++){

  //    var oCells = dd22table.rows.item(i).cells;

  //    //gets amount of cells of current row
  //    var cellLength = oCells.length;

  //    //loops through each cell in current row
  //    rowdata = [];
  //    for(var j = 0; j < cellLength; j++){
  //       // get your cell info here

  //       var cellVal = oCells.item(j).innerHTML;
  //       rowdata.push(cellVal);

  //    }
  //    tabdata.push(rowdata);
  // }

  // reg['dd22table'] = tabdata;

  //dd2file xu ly sau

  if (reg["dd3dat"] == "1") {
    dd3dat.checked = true;
  } else {
    dd3dat.checked = false;
  }

  if (reg["dd4giathapnhat"] == "1") {
    dd4giathapnhat.checked = true;
  } else {
    dd4giathapnhat.checked = false;
  }

  suachuong3.showModal();
}

function displayeditchuong4(rt) {
  chuong4data = JSON.parse(rt);
  //chuong2data = JSON.parse(chuong2data);
  var reg = chuong4data;

  if (reg["ed1dcheck"] == "1") {
    ed1dcheck.checked = true;
    ed1dnocheck.checked = false;
  } else {
    ed1dcheck.checked = false;
    ed1dnocheck.checked = true;
  }

  if (reg["ed1echeck"] == "1") {
    ed1echeck.checked = true;
    ed1enocheck.checked = false;
  } else {
    ed1echeck.checked = false;
    ed1enocheck.checked = true;
  }

  suachuong4.showModal();
}

function displaychuong4(rt) {
  chuong4data = JSON.parse(rt);
  //chuong2data = JSON.parse(chuong2data);
  var reg = chuong4data;

  if (reg["ed1dcheck"] == "1") {
    e1ddichvu.innerHTML = "Có";
  } else {
    e1ddichvu.innerHTML = "Không";
  }

  if (reg["ed1echeck"] == "1") {
    e1ephutung.innerHTML = "Có";
  } else {
    e1ephutung.innerHTML = "Không";
  }

  xemchuong4.showModal();
}

function displaychuong5(rt) {
  let chuong5data = JSON.parse(rt);
  //chuong2data = JSON.parse(chuong2data);
  var reg = chuong5data;

  document.getElementById("Fchidankythuat").value = reg["Fchidankythuat"];

  xemchuong5.showModal();
}

function displayeditchuong7(rt) {
  chuong7data = JSON.parse(rt);
  //chuong2data = JSON.parse(chuong2data);
  var reg = chuong7data;

  document.getElementById("GD13chudautu").value = reg["GD13chudautu"];
  document.getElementById("GD13diachi").value = reg["GD13diachi"];
  document.getElementById("GD13thue").value = reg["GD13thue"];
  document.getElementById("GD13taikhoan").value = reg["GD13taikhoan"];
  document.getElementById("GD13dienthoai").value = reg["GD13dienthoai"];
  document.getElementById("GD13fax").value = reg["GD13fax"];
  document.getElementById("GD13email").value = reg["GD13email"];
  document.getElementById("GD13daidien").value = reg["GD13daidien"];
  document.getElementById("GD15congtrinh").value = reg["GD15congtrinh"];
  document.getElementById("GD18diachi").value = reg["GD18diachi"];
  document.getElementById("GD18banve").value = reg["GD18banve"];
  document.getElementById("GD113ngay").value = reg["GD113ngay"];
  document.getElementById("GD114ngay").value = reg["GD114ngay"];
  document.getElementById("GD115khoicong").value = reg["GD115khoicong"];
  document.getElementById("GD116nhathau").value = reg["GD116nhathau"];
  document.getElementById("GD116diadiem").value = reg["GD116diadiem"];
  document.getElementById("GD116thue").value = reg["GD116thue"];
  document.getElementById("GD116taikhoan").value = reg["GD116taikhoan"];
  document.getElementById("GD116dienthoai").value = reg["GD116dienthoai"];
  document.getElementById("GD116fax").value = reg["GD116fax"];
  document.getElementById("GD116email").value = reg["GD116email"];
  document.getElementById("GD126tuvan").value = reg["GD126tuvan"];
  document.getElementById("GD126diachi").value = reg["GD126diachi"];
  document.getElementById("GD126dienthoai").value = reg["GD126dienthoai"];
  document.getElementById("GD126fax").value = reg["GD126fax"];
  document.getElementById("GD126email").value = reg["GD126email"];
  document.getElementById("GD21thanhphan").value = reg["GD21thanhphan"];
  document.getElementById("GD23tailieu").value = reg["GD23tailieu"];
  document.getElementById("GD51giatri").value = reg["GD51giatri"];
  document.getElementById("GD51thoigian").value = reg["GD51thoigian"];
  document.getElementById("GD54thoihan").value = reg["GD54thoihan"];
  document.getElementById("GD71nhathauphu").value = reg["GD71nhathauphu"];
  document.getElementById("GD72giatri").value = reg["GD72giatri"];
  document.getElementById("GD74yeucaunhathauphu").value =
    reg["GD74yeucaunhathauphu"];
  document.getElementById("GD14baohiem").value = reg["GD14baohiem"];
  document.getElementById("GD15thongtincongtruong").value =
    reg["GD15thongtincongtruong"];
  document.getElementById("GD18ngaytiepnhan").value = reg["GD18ngaytiepnhan"];
  document.getElementById("GD212hoagiai").value = reg["GD212hoagiai"];
  document.getElementById("GD212giaiquyettranhchap").value =
    reg["GD212giaiquyettranhchap"];
  document.getElementById("GD22khoicong").value = reg["GD22khoicong"];
  document.getElementById("GD22ngayhoanthanh").value = reg["GD22ngayhoanthanh"];
  document.getElementById("GD231ngaykhoicong").value = reg["GD231ngaykhoicong"];
  document.getElementById("GD234bieutien").value = reg["GD234bieutien"];
  document.getElementById("GD234sotiengiu").value = reg["GD234sotiengiu"];
  document.getElementById("GD243truonghopkhac").value =
    reg["GD243truonghopkhac"];
  document.getElementById("GD272vattu").value = reg["GD272vattu"];
  document.getElementById("GD33hopdong").value = reg["GD33hopdong"];
  document.getElementById("GD341giahopdong").value = reg["GD341giahopdong"];
  document.getElementById("GD351tamung").value = reg["GD351tamung"];
  document.getElementById("GD351thoigiantamung").value =
    reg["GD351thoigiantamung"];
  document.getElementById("GD371ppthanhtoan").value = reg["GD371ppthanhtoan"];

  if (reg["GD38thuecheck"] == "1") {
    document.getElementById("GD38thuecheck").checked = true;
    document.getElementById("GD38thuenocheck").checked = false;
    document.getElementById("GD38checkcontent").style.display = "flex";
    document.getElementById("GD38blank").value = reg["GD38blank"];
  } else {
    document.getElementById("GD38thuecheck").checked = false;
    document.getElementById("GD38thuenocheck").checked = true;
    document.getElementById("GD38checkcontent").style.display = "none";
  }

  document.getElementById("GD391tiengiulai").value = reg["GD391tiengiulai"];
  document.getElementById("GD401suahopdong").value = reg["GD401suahopdong"];
  document.getElementById("GD407dexuatgiaiphap").value =
    reg["GD407dexuatgiaiphap"];
  document.getElementById("GD421mucphat").value = reg["GD421mucphat"];

  if (reg["GD422boithuongcheck"] == "1") {
    document.getElementById("GD422boithuongcheck").checked = true;
    document.getElementById("GD422boithuongnocheck").checked = false;
    document.getElementById("GD422checkcontent").style.display = "flex";
    document.getElementById("GD422blank").value = reg["GD422blank"];
  } else {
    document.getElementById("GD422boithuongcheck").checked = false;
    document.getElementById("GD422boithuongnocheck").checked = true;
    document.getElementById("GD422checkcontent").style.display = "none";
  }

  if (reg["GD423thuongcheck"] == "1") {
    document.getElementById("GD423thuongcheck").checked = true;
    document.getElementById("GD423thuongnocheck").checked = false;
    document.getElementById("GD423checkcontent").style.display = "flex";
    document.getElementById("GD423blank").value = reg["GD422blank"];
  } else {
    document.getElementById("GD423thuongcheck").checked = false;
    document.getElementById("GD423thuongnocheck").checked = true;
    document.getElementById("GD423checkcontent").style.display = "none";
  }

  document.getElementById("GD47thoigianbangiao").value =
    reg["GD47thoigianbangiao"];
  document.getElementById("GD481thoigiannop").value = reg["GD481thoigiannop"];
  document.getElementById("GD482tiengiulai").value = reg["GD482tiengiulai"];
  document.getElementById("GDblank").value = reg["GDblank"];

  suachuong7.showModal();
}

function displaychuong7(rt) {
  chuong7data = JSON.parse(rt);
  //chuong2data = JSON.parse(chuong2data);
  var reg = chuong7data;

  document.getElementById("G13chudautu").value = reg["GD13chudautu"];
  document.getElementById("G13diachi").value = reg["GD13diachi"];
  document.getElementById("G13thue").value = reg["GD13thue"];
  document.getElementById("G13taikhoan").value = reg["GD13taikhoan"];
  document.getElementById("G13dienthoai").value = reg["GD13dienthoai"];
  document.getElementById("G13fax").value = reg["GD13fax"];
  document.getElementById("G13email").value = reg["GD13email"];
  document.getElementById("G13daidien").value = reg["GD13daidien"];
  document.getElementById("G15congtrinh").value = reg["GD15congtrinh"];
  document.getElementById("G18diachi").value = reg["GD18diachi"];
  document.getElementById("G18banve").value = reg["GD18banve"];
  document.getElementById("G113ngay").value = reg["GD113ngay"];
  document.getElementById("G114ngay").value = reg["GD114ngay"];
  document.getElementById("G115khoicong").value = reg["GD115khoicong"];
  document.getElementById("G116nhathau").value = reg["GD116nhathau"];
  document.getElementById("G116diadiem").value = reg["GD116diadiem"];
  document.getElementById("G116thue").value = reg["GD116thue"];
  document.getElementById("G116taikhoan").value = reg["GD116taikhoan"];
  document.getElementById("G116dienthoai").value = reg["GD116dienthoai"];
  document.getElementById("G116fax").value = reg["GD116fax"];
  document.getElementById("G116email").value = reg["GD116email"];
  document.getElementById("G126tuvan").value = reg["GD126tuvan"];
  document.getElementById("G126diachi").value = reg["GD126diachi"];
  document.getElementById("G126dienthoai").value = reg["GD126dienthoai"];
  document.getElementById("G126fax").value = reg["GD126fax"];
  document.getElementById("G126email").value = reg["GD126email"];
  document.getElementById("G21thanhphan").value = reg["GD21thanhphan"];
  document.getElementById("G23tailieu").value = reg["GD23tailieu"];
  document.getElementById("G51giatri").value = reg["GD51giatri"];
  document.getElementById("G51thoigian").value = reg["GD51thoigian"];
  document.getElementById("G54thoihan").value = reg["GD54thoihan"];
  document.getElementById("G71nhathauphu").value = reg["GD71nhathauphu"];
  document.getElementById("G72giatri").value = reg["GD72giatri"];
  document.getElementById("G74yeucaunhathauphu").value =
    reg["GD74yeucaunhathauphu"];
  document.getElementById("G14baohiem").value = reg["GD14baohiem"];
  document.getElementById("G15thongtincongtruong").value =
    reg["GD15thongtincongtruong"];
  document.getElementById("G18ngaytiepnhan").value = reg["GD18ngaytiepnhan"];
  document.getElementById("G212hoagiai").value = reg["GD212hoagiai"];
  document.getElementById("G212giaiquyettranhchap").value =
    reg["GD212giaiquyettranhchap"];
  document.getElementById("G22khoicong").value = reg["GD22khoicong"];
  document.getElementById("G22ngayhoanthanh").value = reg["GD22ngayhoanthanh"];
  document.getElementById("G231ngaykhoicong").value = reg["GD231ngaykhoicong"];
  document.getElementById("G234bieutien").value = reg["GD234bieutien"];
  document.getElementById("G234sotiengiu").value = reg["GD234sotiengiu"];
  document.getElementById("G243truonghopkhac").value =
    reg["GD243truonghopkhac"];
  document.getElementById("G272vattu").value = reg["GD272vattu"];
  document.getElementById("G33hopdong").value = reg["GD33hopdong"];
  document.getElementById("G341giahopdong").value = reg["GD341giahopdong"];
  document.getElementById("G351tamung").value = reg["GD351tamung"];
  document.getElementById("G351thoigiantamung").value =
    reg["GD351thoigiantamung"];
  document.getElementById("G371ppthanhtoan").value = reg["GD371ppthanhtoan"];

  if (reg["G38thuecheck"] == "1") {
    document.getElementById("G38thuecheck").checked = true;
    document.getElementById("G38thuenocheck").checked = false;
    document.getElementById("G38checkcontent").style.display = "flex";
    document.getElementById("G38blank").value = reg["GD38blank"];
  } else {
    document.getElementById("G38thuecheck").checked = false;
    document.getElementById("G38thuenocheck").checked = true;
    document.getElementById("G38checkcontent").style.display = "none";
  }

  document.getElementById("G391tiengiulai").value = reg["GD391tiengiulai"];
  document.getElementById("G401suahopdong").value = reg["GD401suahopdong"];
  document.getElementById("G407dexuatgiaiphap").value =
    reg["GD407dexuatgiaiphap"];
  document.getElementById("G421mucphat").value = reg["GD421mucphat"];

  if (reg["G422boithuongcheck"] == "1") {
    document.getElementById("G422boithuongcheck").checked = true;
    document.getElementById("G422boithuongnocheck").checked = false;
    document.getElementById("G422checkcontent").style.display = "block";
    document.getElementById("G422blank").value = reg["GD422blank"];
  } else {
    document.getElementById("G422boithuongcheck").checked = false;
    document.getElementById("G422boithuongnocheck").checked = true;
    document.getElementById("G422checkcontent").style.display = "none";
  }

  if (reg["G423thuongcheck"] == "1") {
    document.getElementById("G423thuongcheck").checked = true;
    document.getElementById("G423thuongnocheck").checked = false;
    document.getElementById("G423checkcontent").style.display = "block";
    document.getElementById("G423blank").value = reg["GD422blank"];
  } else {
    document.getElementById("G423thuongcheck").checked = false;
    document.getElementById("G423thuongnocheck").checked = true;
    document.getElementById("G423checkcontent").style.display = "none";
  }

  document.getElementById("G47thoigianbangiao").value =
    reg["GD47thoigianbangiao"];
  document.getElementById("G481thoigiannop").value = reg["GD481thoigiannop"];
  document.getElementById("G482tiengiulai").value = reg["GD482tiengiulai"];
  document.getElementById("Gblank").value = reg["GDblank"];

  xemchuong7.showModal();
}

function displayeditchuong8(rt) {
  let chuong8data = JSON.parse(rt);
  //chuong2data = JSON.parse(chuong2data);
  var reg = chuong8data;
  hd14hopdongname.innerHTML = reg["hd14hopdong"];
  hd14phulucname.innerHTML = reg["hd14phuluc"];

  suachuong8.showModal();
}

function displaychuong8(rt) {
  let chuong8data = JSON.parse(rt);
  //chuong2data = JSON.parse(chuong2data);
  var reg = chuong8data;
  h14hopdong.innerHTML = reg["hd14hopdong"];
  h14phuluc.innerHTML = reg["hd14phuluc"];

  xemchuong8.showModal();
}

function selectFile() {
  hd14hopdong.click();
}

function handleFiles(files) {
  hd14hopdongname.innerHTML = files[0].name;
}

function selectFile1() {
  hd17phuluc.click();
}

function handleFiles1(files) {
  hd17phulucname.innerHTML = files[0].name;
}

function suatieuchuan() {
  var reg = {};
  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  var xhr = new XMLHttpRequest();
  suachuong3.showModal();
  // xhr.open('POST', '/api/getehsmt/chuong3', true);
  // xhr.onreadystatechange = function () {
  //     if (xhr.readyState === 4) {
  //         if (xhr.status === 200) {
  //             //alert('Lấy chương 2 thành công!');
  //             let rt = this.responseText;
  //             if (rt.length < 10) {
  //                 suachuong3.showModal();
  //             } else {
  //                 displayeditchuong3(rt);
  //             }

  //             //rightButton.disabled = false;
  //         } else {
  //             alert('Lấy EHSMT chương 3 lỗi');
  //             //saveButton.disabled = false;
  //         }
  //     }
  // };
  // let st = JSON.stringify(reg);
  // xhr.send(st);

  //suachuong3.showModal();
}
function dongsuatieuchuan() {
  suachuong3.close();
}
function xemtieuchuan() {
  var reg = {};
  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  var xhr = new XMLHttpRequest();
  // xhr.open('POST', '/api/getehsmt/chuong3', true);
  // xhr.onreadystatechange = function () {
  //     if (xhr.readyState === 4) {
  //         if (xhr.status === 200) {
  //             //alert('Lấy chương 2 thành công!');
  //             let rt = this.responseText;
  //             if (rt.length < 10) {
  //                 alert('Mục này chưa ghi vào cơ sở dữ liệu hoặc đường truyền lỗi!');
  //             } else {
  //                 displaychuong3(rt);
  //             }

  //             //rightButton.disabled = false;
  //         } else {
  //             alert('Lấy EHSMT chương 3 lỗi');
  //             //saveButton.disabled = false;
  //         }
  //     }
  // };
  // let st = JSON.stringify(reg);
  // xhr.send(st);

  xemchuong3.showModal();
}
function dongxemtieuchuan() {
  xemchuong3.close();
}
function suabieumaumoithau() {
  var reg = {};
  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  var xhr = new XMLHttpRequest();
  suachuong4.showModal();
  // xhr.open('POST', '/api/getehsmt/chuong4', true);
  // xhr.onreadystatechange = function () {
  //     if (xhr.readyState === 4) {
  //         if (xhr.status === 200) {
  //             //alert('Lấy chương 2 thành công!');
  //             let rt = this.responseText;
  //             if (rt.length < 10) {
  //                 //alert('Mục này chưa ghi vào cơ sở dữ liệu hoặc đường truyền lỗi!');
  //                 suachuong4.showModal();
  //             } else {
  //                 displayeditchuong4(rt);
  //             }

  //             //rightButton.disabled = false;
  //         } else {
  //             alert('Lấy EHSMT BMMT lỗi');
  //             suachuong4.showModal();
  //             //saveButton.disabled = false;
  //         }
  //     }
  // };
  // let st = JSON.stringify(reg);
  // xhr.send(st);
}
function dongsuabieumaumoithau() {
  suachuong4.close();
}
function xembieumaumoithau() {
  var reg = {};
  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  var xhr = new XMLHttpRequest();
  // xhr.open('POST', '/api/getehsmt/chuong4', true);
  // xhr.onreadystatechange = function () {
  //     if (xhr.readyState === 4) {
  //         if (xhr.status === 200) {
  //             //alert('Lấy chương 2 thành công!');
  //             let rt = this.responseText;
  //             if (rt.length < 10) {
  //                 alert('Mục này chưa ghi vào cơ sở dữ liệu hoặc đường truyền lỗi!');
  //             } else {
  //                 displaychuong4(rt);
  //             }

  //             //rightButton.disabled = false;
  //         } else {
  //             alert('Lấy EHSMT BMMT lỗi');
  //             //chuong4.showModal();
  //             //saveButton.disabled = false;
  //         }
  //     }
  // };
  // let st = JSON.stringify(reg);
  // xhr.send(st);

  xemchuong4.showModal();
}
function dongxembieumaumoithau() {
  xemchuong4.close();
}
function yeucaukythuat() {
  var reg = {};
  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  var xhr = new XMLHttpRequest();
  // xhr.open('POST', '/api/getehsmt/chuong5', true);
  // xhr.onreadystatechange = function () {
  //     if (xhr.readyState === 4) {
  //         if (xhr.status === 200) {
  //             //alert('Lấy chương 2 thành công!');
  //             let rt = this.responseText;
  //             if (rt.length < 10) {
  //                 alert('Mục này chưa ghi vào cơ sở dữ liệu hoặc đường truyền lỗi!');
  //             } else {
  //                 displaychuong5(rt);
  //             }

  //             //rightButton.disabled = false;
  //         } else {
  //             alert('Lấy EHSMT chỉ dẫn kỹ thuật lỗi');
  //             xemchuong5.showModal();
  //             //saveButton.disabled = false;
  //         }
  //     }
  // };
  // let st = JSON.stringify(reg);
  // xhr.send(st);

  xemchuong5.showModal();
}
function dongxemchuong5() {
  xemchuong5.close();
}
function xemdieukienchung() {
  xemchuong6.showModal();
}
function dongxemchuong6() {
  xemchuong6.close();
}
function suadieukiencuthe() {
  var reg = {};
  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  var xhr = new XMLHttpRequest();
  // xhr.open('POST', '/api/getehsmt/chuong7', true);
  // xhr.onreadystatechange = function () {
  //     if (xhr.readyState === 4) {
  //         if (xhr.status === 200) {
  //             //alert('Lấy chương 2 thành công!');
  //             let rt = this.responseText;
  //             if (rt.length < 10) {
  //                 //alert('Mục này chưa ghi vào cơ sở dữ liệu hoặc đường truyền lỗi!');
  //                 suachuong7.showModal();
  //             } else {
  //                 displayeditchuong7(rt);
  //             }

  //             //rightButton.disabled = false;
  //         } else {
  //             alert('Lấy EHSMT chương 7 lỗi');
  //             suachuong7.showModal();
  //             //saveButton.disabled = false;
  //         }
  //     }
  // };
  // let st = JSON.stringify(reg);
  // xhr.send(st);

  suachuong7.showModal();
}
function dongsuachuong7() {
  suachuong7.close();
}
function xemdieukiencuthe() {
  var reg = {};
  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  var xhr = new XMLHttpRequest();
  // xhr.open('POST', '/api/getehsmt/chuong7', true);
  // xhr.onreadystatechange = function () {
  //     if (xhr.readyState === 4) {
  //         if (xhr.status === 200) {
  //             //alert('Lấy chương 2 thành công!');
  //             let rt = this.responseText;
  //             if (rt.length < 10) {
  //                 alert('Mục này chưa ghi vào cơ sở dữ liệu hoặc đường truyền lỗi!');
  //             } else {
  //                 displaychuong7(rt);
  //             }

  //             //rightButton.disabled = false;
  //         } else {
  //             alert('Lấy EHSMT chương 7 lỗi');
  //             //xemchuong7.showModal();
  //             //saveButton.disabled = false;
  //         }
  //     }
  // };
  // let st = JSON.stringify(reg);
  // xhr.send(st);

  xemchuong7.showModal();
}
function dongxemchuong7() {
  xemchuong7.close();
}
function suabieumauhopdong() {
  var reg = {};
  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  var xhr = new XMLHttpRequest();
  // xhr.open('POST', '/api/getehsmt/chuong8', true);
  // xhr.onreadystatechange = function () {
  //     if (xhr.readyState === 4) {
  //         if (xhr.status === 200) {
  //             //alert('Lấy chương 2 thành công!');
  //             let rt = this.responseText;
  //             if (rt.length < 10) {
  //                 //alert('Mục này chưa ghi vào cơ sở dữ liệu hoặc đường truyền lỗi!');
  //                 //alert('Mục này soạn thảo lần đầu!');
  //                 suachuong8.showModal()
  //             } else {
  //                 displayeditchuong8(rt);
  //             }

  //             //rightButton.disabled = false;
  //         } else {
  //             alert('Lấy EHSMT chương 8 lỗi');
  //             suachuong8.showModal();
  //             //saveButton.disabled = false;
  //         }
  //     }
  // };
  // let st = JSON.stringify(reg);
  // xhr.send(st);

  suachuong8.showModal();
}
function dongsuabieumauhopdong() {
  suachuong8.close();
}
function xembieumauhopdong() {
  var reg = {};
  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  var xhr = new XMLHttpRequest();
  // xhr.open('POST', '/api/getehsmt/chuong8', true);
  // xhr.onreadystatechange = function () {
  //     if (xhr.readyState === 4) {
  //         if (xhr.status === 200) {
  //             //alert('Lấy chương 2 thành công!');
  //             let rt = this.responseText;
  //             if (rt.length < 10) {
  //                 alert('Mục này chưa ghi vào cơ sở dữ liệu hoặc đường truyền lỗi!');
  //                 //alert('Mục này soạn thảo lần đầu!');
  //                 //suachuong8.showModal()
  //             } else {
  //                 displaychuong8(rt);
  //             }

  //             //rightButton.disabled = false;
  //         } else {
  //             alert('Lấy EHSMT chương 8 lỗi');
  //             //suachuong8.showModal();
  //             //saveButton.disabled = false;
  //         }
  //     }
  // };
  // let st = JSON.stringify(reg);
  // xhr.send(st);

  xemchuong8.showModal();
}
function dongbieumauhopdong() {
  xemchuong8.close();
}
function suabangone() {
  //alert('abc');
  suabangsomot.style.display = "block";
  suabangsohai.style.display = "none";
  document.getElementById("suanutso1").style.color = "white";
  document.getElementById("suanutso1").style.backgroundColor = "#064d69";
  document.getElementById("suanutso2").style.backgroundColor = "white";
  document.getElementById("suanutso2").style.color = "grey";
}
function suabangtwo() {
  //alert('abc');
  suabangsomot.style.display = "none";
  suabangsohai.style.display = "block";
  document.getElementById("suanutso1").style.color = "grey";
  document.getElementById("suanutso2").style.backgroundColor = "#064d69";
  document.getElementById("suanutso1").style.backgroundColor = "white";
  document.getElementById("suanutso2").style.color = "white";
}

function xembangone() {
  //alert('abc');
  xembangsomot.style.display = "block";
  xembangsohai.style.display = "none";
  document.getElementById("xemnutso1").style.color = "white";
  document.getElementById("xemnutso1").style.backgroundColor = "#064d69";
  document.getElementById("xemnutso2").style.backgroundColor = "white";
  document.getElementById("xemnutso2").style.color = "grey";
}
function xembangtwo() {
  //alert('abc');
  xembangsomot.style.display = "none";
  xembangsohai.style.display = "block";
  document.getElementById("xemnutso1").style.color = "grey";
  document.getElementById("xemnutso2").style.backgroundColor = "#064d69";
  document.getElementById("xemnutso1").style.backgroundColor = "white";
  document.getElementById("xemnutso2").style.color = "white";
}

function downghichu() {
  const gch = document.getElementById("ghichumuc3");
  const bieutuong = document.getElementById("bieutuongghichu");
  if (gch.style.display == "none") {
    bieutuong.innerHTML =
      '<i class="fa fa-angle-up" aria-hidden="true"></i> Ghi chú';
    gch.style.display = "block";
  } else {
    bieutuong.innerHTML =
      '<i class="fa fa-angle-down" aria-hidden="true"></i> Ghi chú';
    gch.style.display = "none";
  }
}

function downxemghichu() {
  const gch1 = document.getElementById("xemghichumuc3");
  const bieutuong1 = document.getElementById("bieutuongghichu1");
  if (gch1.style.display == "none") {
    bieutuong1.innerHTML =
      '<i class="fa fa-angle-up" aria-hidden="true"></i> Ghi chú';
    gch1.style.display = "block";
  } else {
    bieutuong1.innerHTML =
      '<i class="fa fa-angle-down" aria-hidden="true"></i> Ghi chú';
    gch1.style.display = "none";
  }
}

function hienmuc1() {
  mucso1.style.display = "block";
  mucso21.style.display = "none";
  mucso22a.style.display = "none";
  mucso22b.style.display = "none";
  mucso3.style.display = "none";
  mucso4.style.display = "none";
}
function hienmuc21() {
  mucso1.style.display = "none";
  mucso21.style.display = "block";
  mucso22a.style.display = "none";
  mucso22b.style.display = "none";
  mucso3.style.display = "none";
  mucso4.style.display = "none";
}
function hienmuc22a() {
  mucso1.style.display = "none";
  mucso21.style.display = "none";
  mucso22a.style.display = "block";
  mucso22b.style.display = "none";
  mucso3.style.display = "none";
  mucso4.style.display = "none";
}
function hienmuc22b() {
  mucso1.style.display = "none";
  mucso21.style.display = "none";
  mucso22a.style.display = "none";
  mucso22b.style.display = "block";
  mucso3.style.display = "none";
  mucso4.style.display = "none";
}

function hienmuc3() {
  mucso1.style.display = "none";
  mucso21.style.display = "none";
  mucso22a.style.display = "none";
  mucso22b.style.display = "none";
  mucso3.style.display = "block";
  mucso4.style.display = "none";
}
function hienmuc4() {
  mucso1.style.display = "none";
  mucso21.style.display = "none";
  mucso22a.style.display = "none";
  mucso22b.style.display = "none";
  mucso3.style.display = "none";
  mucso4.style.display = "block";
}

function hiensuamuc1() {
  suamuc1.style.display = "block";
  suamuc21.style.display = "none";
  suamuc22a.style.display = "none";
  suamuc22b.style.display = "none";
  suamuc3.style.display = "none";
  suamuc4.style.display = "none";
}
function hiensuamuc21() {
  suamuc1.style.display = "none";
  suamuc21.style.display = "block";
  suamuc22a.style.display = "none";
  suamuc22b.style.display = "none";
  suamuc3.style.display = "none";
  suamuc4.style.display = "none";
}
function hiensuamuc22a() {
  suamuc1.style.display = "none";
  suamuc21.style.display = "none";
  suamuc22a.style.display = "block";
  suamuc22b.style.display = "none";
  suamuc3.style.display = "none";
  suamuc4.style.display = "none";
}
function hiensuamuc22b() {
  suamuc1.style.display = "none";
  suamuc21.style.display = "none";
  suamuc22a.style.display = "none";
  suamuc22b.style.display = "block";
  suamuc3.style.display = "none";
  suamuc4.style.display = "none";
}
function hiensuamuc3() {
  suamuc1.style.display = "none";
  suamuc21.style.display = "none";
  suamuc22a.style.display = "none";
  suamuc22b.style.display = "none";
  suamuc3.style.display = "block";
  suamuc4.style.display = "none";
}
function hiensuamuc4() {
  suamuc1.style.display = "none";
  suamuc21.style.display = "none";
  suamuc22a.style.display = "none";
  suamuc22b.style.display = "none";
  suamuc3.style.display = "none";
  suamuc4.style.display = "block";
}

function mauso01A() {
  muc1A.style.display = "block";
  muc1E.style.display = "none";
}
function mauso01E() {
  muc1A.style.display = "none";
  muc1E.style.display = "block";
}

function suamauso01A() {
  suamuc1A.style.display = "block";

  suamuc1E.style.display = "none";
}

function suamauso01E() {
  suamuc1A.style.display = "none";

  suamuc1E.style.display = "block";
}

function mauso13() {
  mau13.style.display = "block";
  mau14.style.display = "none";
  mau15.style.display = "none";
  mau16.style.display = "none";
  mau17.style.display = "none";
  bottomchuong8.style.display = "none";
}
function mauso14() {
  mau13.style.display = "none";
  mau14.style.display = "block";
  mau15.style.display = "none";
  mau16.style.display = "none";
  mau17.style.display = "none";
  bottomchuong8.style.display = "flex";
}
function mauso15() {
  mau13.style.display = "none";
  mau14.style.display = "none";
  mau15.style.display = "block";
  mau16.style.display = "none";
  mau17.style.display = "none";
  bottomchuong8.style.display = "none";
}
function mauso16() {
  mau13.style.display = "none";
  mau14.style.display = "none";
  mau15.style.display = "none";
  mau16.style.display = "block";
  mau17.style.display = "none";
  bottomchuong8.style.display = "none";
}
function mauso17() {
  mau13.style.display = "none";
  mau14.style.display = "none";
  mau15.style.display = "none";
  mau16.style.display = "none";
  mau17.style.display = "block";
  bottomchuong8.style.display = "none";
}

function xemmauso13() {
  xemmau13.style.display = "block";
  xemmau14.style.display = "none";
  xemmau15.style.display = "none";
  xemmau16.style.display = "none";
  xemmau17.style.display = "none";
}
function xemmauso14() {
  xemmau13.style.display = "none";
  xemmau14.style.display = "block";
  xemmau15.style.display = "none";
  xemmau16.style.display = "none";
  xemmau17.style.display = "none";
}
function xemmauso15() {
  xemmau13.style.display = "none";
  xemmau14.style.display = "none";
  xemmau15.style.display = "block";
  xemmau16.style.display = "none";
  xemmau17.style.display = "none";
}
function xemmauso16() {
  xemmau13.style.display = "none";
  xemmau14.style.display = "none";
  xemmau15.style.display = "none";
  xemmau16.style.display = "block";
  xemmau17.style.display = "none";
}

function xemmauso17() {
  xemmau13.style.display = "none";
  xemmau14.style.display = "none";
  xemmau15.style.display = "none";
  xemmau16.style.display = "none";
  xemmau17.style.display = "block";
}

// function xuatpdfChidan() {
//   //chidanthu = document.getElementById('chidanthu')
//   //window.open('/static/uploads/mautbmt/Chuong13Axaylap1tui.pdf');

//   window.open("/api/download/Chuong1_4A.pdf");
//   //html2pdf().from(chidanthu).save();
//   //alert('Xuat pdf');
// }

function luusuachuong2() {
  var reg = {};

  reg["CD11chudautu"] = document.getElementById("CD11chudautu").value;
  reg["CD12tengoithau"] = document.getElementById("CD12tengoithau").value;
  reg["CD12tendutoan"] = document.getElementById("CD12tendutoan").value;
  reg["CD3nguonvon"] = document.getElementById("CD3nguonvon").value;
  reg["CD51cchudautu"] = document.getElementById("CD51cchudautu").value;
  reg["CD51cdiachi"] = document.getElementById("CD51cdiachi").value;
  reg["CD51cbenmoithau"] = document.getElementById("CD51cbenmoithau").value;
  reg["CD51cdiachibmt"] = document.getElementById("CD51cdiachibmt").value;

  let tabdata = [];
  let row = document.getElementById("CD51table").rows.length;
  let id1, id2, id3, id4, id5;
  for (let i = 1; i < row; i++) {
    id1 = "CD51T" + String(i) + "1";
    id2 = "CD51T" + String(i) + "2";
    id3 = "CD51T" + String(i) + "3";
    id4 = "CD51T" + String(i) + "4";
    id5 = "CD51T" + String(i) + "5";
    let rowdat = [];
    rowdat.push(document.getElementById(id1).value);
    if (document.getElementById(id2).checked) {
      rowdat.push("1");
    } else {
      rowdat.push("0");
    }
    if (document.getElementById(id3).checked) {
      rowdat.push("1");
    } else {
      rowdat.push("0");
    }
    rowdat.push(document.getElementById(id4).value);
    rowdat.push(document.getElementById(id5).value);
    tabdata.push(rowdat);
  }

  reg["CD51table"] = tabdata;

  reg["CD51gdieukiendoanhnghiep"] = document.getElementById(
    "CD51gdieukiendoanhnghiep"
  ).value;

  if (document.getElementById("CD76check").checked == true) {
    reg["CD76check"] = "1";
  } else {
    reg["CD76check"] = "0";
  }

  if (document.getElementById("CD76nocheck").checked == true) {
    reg["CD76nocheck"] = "1";
  } else {
    reg["CD76nocheck"] = "0";
  }

  reg["CD76checkthoigian"] = document.getElementById("CD76checkthoigian").value;
  reg["CD76checkdiadiem"] = document.getElementById("CD76checkdiadiem").value;
  reg["CD76checkdienthoai"] =
    document.getElementById("CD76checkdienthoai").value;

  if (document.getElementById("CD77check").checked == true) {
    reg["CD77check"] = "1";
  } else {
    reg["CD77check"] = "0";
  }

  if (document.getElementById("CD77nocheck").checked == true) {
    reg["CD77nocheck"] = "1";
  } else {
    reg["CD77nocheck"] = "0";
  }

  reg["CD77checkthoigian"] = document.getElementById("CD77checkthoigian").value;
  reg["CD77checkdiadiem"] = document.getElementById("CD77checkdiadiem").value;
  reg["CD77checkdienthoai"] =
    document.getElementById("CD77checkdienthoai").value;

  reg["CD8chiphi"] = document.getElementById("CD8chiphi").value;
  reg["CD108tailieu"] = document.getElementById("CD108tailieu").value;

  if (document.getElementById("CD121check").checked == true) {
    reg["CD121check"] = "1";
  } else {
    reg["CD121check"] = "0";
  }

  if (document.getElementById("CD121nocheck").checked == true) {
    reg["CD121nocheck"] = "1";
  } else {
    reg["CD121nocheck"] = "0";
  }

  reg["CD171thoihan"] = document.getElementById("CD171thoihan").value;
  reg["CD182giatri"] = document.getElementById("CD182giatri").value;
  reg["CD182thoigian"] = document.getElementById("CD182thoigian").value;
  reg["CD184thoigian"] = document.getElementById("CD184thoigian").value;

  if (document.getElementById("CD275check").checked == true) {
    reg["CD275check"] = "1";
  } else {
    reg["CD275check"] = "0";
  }

  if (document.getElementById("CD275nocheck").checked == true) {
    reg["CD275nocheck"] = "1";
  } else {
    reg["CD275nocheck"] = "0";
  }

  reg["CD301nangluc"] = document.getElementById("CD301nangluc").innerHTML;
  reg["CD301kythuat"] = document.getElementById("CD301kythuat").innerHTML;
  reg["CD301taichinh"] = document.getElementById("CD301taichinh").innerHTML;
  reg["CD302xephangnhathau"] = document.getElementById(
    "CD302xephangnhathau"
  ).value;
  reg["CD324"] = document.getElementById("CD324").value;
  reg["CD325giagoithau"] = document.getElementById("CD325giagoithau").value;
  reg["CD382thamquyen"] = document.getElementById("CD382thamquyen").value;
  reg["CD382diachi"] = document.getElementById("CD382diachi").value;
  reg["CD382email"] = document.getElementById("CD382email").value;
  reg["CD382diachithuongtruc"] = document.getElementById(
    "CD382diachithuongtruc"
  ).value;
  reg["CD382emailgiupviec"] =
    document.getElementById("CD382emailgiupviec").value;

  if (document.getElementById("CD39check").checked == true) {
    reg["CD39check"] = "1";
  } else {
    reg["CD39check"] = "0";
  }

  if (document.getElementById("CD39nocheck").checked == true) {
    reg["CD39nocheck"] = "1";
  } else {
    reg["CD39nocheck"] = "0";
  }

  reg["CD39ten"] = document.getElementById("CD39ten").value;
  reg["CD39diachi"] = document.getElementById("CD39diachi").value;
  reg["CD39dienthoai"] = document.getElementById("CD39dienthoai").value;
  reg["CD39fax"] = document.getElementById("CD39fax").value;

  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  reg["makhlcnt"] = makhlcnt.value;
  reg["hinhthuclcnt"] = hinhthuclcnt.value;
  reg["phuongthuclcnt"] = phuongthuclcnt.value;

  var xhr = new XMLHttpRequest();
  xhr.open("POST", "/api/saveehsmt/chuong2", true);
  xhr.onreadystatechange = function () {
    if (xhr.readyState === 4) {
      if (xhr.status === 200) {
        alert("Lưu bảng dữ liệu thành công!");
        suachuong2.close();
        //rightButton.disabled = false;
      } else {
        alert("Lưu bảng dữ liệu lỗi");
        //saveButton.disabled = false;
      }
    }
  };
  let st = JSON.stringify(reg);
  xhr.send(st);

  savechidan = reg;
}

function xuatPDFChuong2() {
  reg = {};
  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  var xhr = new XMLHttpRequest();
  xhr.open("POST", "/api/xuatPDF/chuong2", true);
  xhr.onreadystatechange = function () {
    if (xhr.readyState === 4) {
      if (xhr.status === 200) {
        //alert('OK');
        //window.open('/api/download/Chuong1_4A.pdf');
        window.location.href = "/api/download/Chuong2_4A.pdf";
        // let rt = this.responseText;
        // if (rt.length < 10) {
        //     alert('Mục này chưa ghi vào cơ sở dữ liệu hoặc đường truyền lỗi!');
        // }
        // else {
        //     alert(rt);
        // }
        //alert('Lưu bảng dữ liệu thành công!');
        //suachuong2.close();
        //rightButton.disabled = false;
      } else {
        alert("Xuất pdf lỗi");
        //saveButton.disabled = false;
      }
    }
  };
  let st = JSON.stringify(reg);
  xhr.send(st);
}

function luusuachuong3() {
  var reg = {};

  reg["dd21dongtien"] = dd21dongtien.value;
  if (dd21b1check1.checked) {
    reg["dd21b1check1"] = "1";
  } else {
    reg["dd21b1check1"] = "0";
  }
  if (dd21b1check2.checked) {
    reg["dd21b1check2"] = "1";
  } else {
    reg["dd21b1check2"] = "0";
  }
  if (dd21b1check3.checked) {
    reg["dd21b1check3"] = "1";
  } else {
    reg["dd21b1check3"] = "0";
  }
  if (dd21b1check4.checked) {
    reg["dd21b1check4"] = "1";
  } else {
    reg["dd21b1check4"] = "0";
  }
  if (dd21b1check5.checked) {
    reg["dd21b1check5"] = "1";
  } else {
    reg["dd21b1check5"] = "0";
  }

  reg["dd21b1sonam"] = dd21b1sonam.value;
  reg["dd21b1sotien"] = dd21b1sotien.value;
  reg["dd21b1lichsu"] = dd21b1lichsu.value;
  reg["dd21b1nhathau"] = dd21b1nhathau.value;
  reg["dd21b1tuongtu"] = dd21b1tuongtu.value;
  reg["dd21b1toithieu"] = dd21b1toithieu.value;

  if (dd21b2check1.checked) {
    reg["dd21b2check1"] = "1";
  } else {
    reg["dd21b2check1"] = "0";
  }
  if (dd21b2check2.checked) {
    reg["dd21b2check2"] = "1";
  } else {
    reg["dd21b2check2"] = "0";
  }
  if (dd21b2check3.checked) {
    reg["dd21b2check3"] = "1";
  } else {
    reg["dd21b2check3"] = "0";
  }
  if (dd21b2check4.checked) {
    reg["dd21b2check4"] = "1";
  } else {
    reg["dd21b2check4"] = "0";
  }
  if (dd21b2check5.checked) {
    reg["dd21b2check5"] = "1";
  } else {
    reg["dd21b2check5"] = "0";
  }

  reg["dd21b2doanhthu"] = dd21b2doanhthu.value;
  reg["dd21b2congsuat"] = dd21b2congsuat.value;
  reg["dd21b2sanluong"] = dd21b2sanluong.value;
  if (dd22nhansucheck.checked) {
    reg["dd22nhansucheck"] = "1";
  } else {
    reg["dd22nhansucheck"] = "0";
  }

  let tabdata = [];

  var rowLength = dd22table.rows.length;

  for (i = 0; i < rowLength; i++) {
    var oCells = dd22table.rows.item(i).cells;

    //gets amount of cells of current row
    var cellLength = oCells.length;

    //loops through each cell in current row
    rowdata = [];
    for (var j = 0; j < cellLength; j++) {
      // get your cell info here

      var cellVal = oCells.item(j).innerHTML;
      rowdata.push(cellVal);
    }
    tabdata.push(rowdata);
  }

  reg["dd22table"] = tabdata;

  //dd2file xu ly sau

  if (dd3dat.checked) {
    reg["dd3dat"] = "1";
  } else {
    reg["dd3dat"] = "0";
  }

  if (dd4giathapnhat.checked) {
    reg["dd4giathapnhat"] = "1";
  } else {
    reg["dd4giathapnhat"] = "0";
  }

  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  reg["makhlcnt"] = makhlcnt.value;
  reg["hinhthuclcnt"] = hinhthuclcnt.value;
  reg["phuongthuclcnt"] = phuongthuclcnt.value;

  var xhr = new XMLHttpRequest();
  xhr.open("POST", "/api/saveehsmt/chuong3", true);
  xhr.onreadystatechange = function () {
    if (xhr.readyState === 4) {
      if (xhr.status === 200) {
        alert("Lưu tiêu chuẩn thành công!");
        suachuong3.close();
        //rightButton.disabled = false;
      } else {
        alert("Lưu tiêu chuẩn lỗi");
        //saveButton.disabled = false;
      }
    }
  };
  let st = JSON.stringify(reg);
  xhr.send(st);
}

function luusuachuong4() {
  var reg = {};

  let tabdata = [];
  let rowdata = [];

  var rowLength = ed1atable.rows.length;

  for (i = 0; i < rowLength; i++) {
    var oCells = ed1atable.rows.item(i).cells;

    //gets amount of cells of current row
    var cellLength = oCells.length;

    //loops through each cell in current row
    rowdata = [];
    for (var j = 0; j < cellLength; j++) {
      // get your cell info here

      var cellVal = oCells.item(j).innerHTML;
      rowdata.push(cellVal);
    }
    tabdata.push(rowdata);
  }

  reg["ed1atable"] = tabdata;

  //reg['ed1afile'] =

  if (ed1dcheck.checked) {
    reg["ed1dcheck"] = "1";
  } else {
    reg["ed1dcheck"] = "0";
  }

  tabdata = [];
  rowdata = [];
  var rowLength = ed1dtable.rows.length;

  for (i = 0; i < rowLength; i++) {
    var oCells = ed1dtable.rows.item(i).cells;

    //gets amount of cells of current row
    var cellLength = oCells.length;

    //loops through each cell in current row
    rowdata = [];
    for (var j = 0; j < cellLength; j++) {
      // get your cell info here

      var cellVal = oCells.item(j).innerHTML;
      rowdata.push(cellVal);
    }
    tabdata.push(rowdata);
  }

  reg["ed1dtable"] = tabdata;

  if (ed1echeck.checked) {
    reg["ed1echeck"] = "1";
  } else {
    reg["ed1echeck"] = "0";
  }

  tabdata = [];
  rowdata = [];
  var rowLength = ed1etable.rows.length;

  for (i = 0; i < rowLength; i++) {
    var oCells = ed1etable.rows.item(i).cells;

    //gets amount of cells of current row
    var cellLength = oCells.length;

    //loops through each cell in current row
    rowdata = [];
    for (var j = 0; j < cellLength; j++) {
      // get your cell info here

      var cellVal = oCells.item(j).innerHTML;
      rowdata.push(cellVal);
    }
    tabdata.push(rowdata);
  }

  reg["ed1etable"] = tabdata;

  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  reg["makhlcnt"] = makhlcnt.value;
  reg["hinhthuclcnt"] = hinhthuclcnt.value;
  reg["phuongthuclcnt"] = phuongthuclcnt.value;

  var xhr = new XMLHttpRequest();
  xhr.open("POST", "/api/saveehsmt/chuong4", true);
  xhr.onreadystatechange = function () {
    if (xhr.readyState === 4) {
      if (xhr.status === 200) {
        alert("Lưu biểu mẫu thành công!");
        suachuong4.close();
        //rightButton.disabled = false;
      } else {
        alert("Lưu biểu mẫu lỗi");
        //saveButton.disabled = false;
      }
    }
  };
  let st = JSON.stringify(reg);
  xhr.send(st);
}

function luusuachuong5() {
  var reg = {};

  reg["Fchidankythuat"] =
    document.getElementById("Fchidankythuat").files[0].name;
  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  reg["makhlcnt"] = makhlcnt.value;
  reg["hinhthuclcnt"] = hinhthuclcnt.value;
  reg["phuongthuclcnt"] = phuongthuclcnt.value;

  var xhr = new XMLHttpRequest();
  xhr.open("POST", "/api/saveehsmt/chuong5", true);
  xhr.onreadystatechange = function () {
    if (xhr.readyState === 4) {
      if (xhr.status === 200) {
        alert("Lưu chỉ dẫn kỹ thuật thành công!");
        xemchuong5.close();
        //rightButton.disabled = false;
      } else {
        alert("Lưu chỉ dẫn kỹ thuật lỗi");
        //saveButton.disabled = false;
      }
    }
  };
  let st = JSON.stringify(reg);
  xhr.send(st);
}

function luusuachuong7() {
  var reg = {};

  if (gd22check1.checked == true) {
    reg["gd22check1"] = "1";
  } else {
    reg["gd22check1"] = "0";
  }

  reg["GD13chudautu"] = document.getElementById("GD13chudautu").value;
  reg["GD13diachi"] = document.getElementById("GD13diachi").value;
  reg["GD13thue"] = document.getElementById("GD13thue").value;
  reg["GD13taikhoan"] = document.getElementById("GD13taikhoan").value;
  reg["GD13dienthoai"] = document.getElementById("GD13dienthoai").value;
  reg["GD13fax"] = document.getElementById("GD13fax").value;
  reg["GD13email"] = document.getElementById("GD13email");
  reg["GD13daidien"] = document.getElementById("GD13daidien").value;
  reg["GD15congtrinh"] = document.getElementById("GD15congtrinh").value;
  reg["GD18diachi"] = document.getElementById("GD18diachi").value;
  reg["GD18banve"] = document.getElementById("GD18banve").value;
  reg["GD113ngay"] = document.getElementById("GD113ngay").value;
  reg["GD114ngay"] = document.getElementById("GD114ngay").value;
  reg["GD115khoicong"] = document.getElementById("GD115khoicong").value;
  reg["GD116nhathau"] = document.getElementById("GD116nhathau").value;
  reg["GD116diadiem"] = document.getElementById("GD116diadiem").value;
  reg["GD116thue"] = document.getElementById("GD116thue").value;
  reg["GD116taikhoan"] = document.getElementById("GD116taikhoan").value;
  reg["GD116dienthoai"] = document.getElementById("GD116dienthoai").value;
  reg["GD116fax"] = document.getElementById("GD116fax").value;
  reg["GD116email"] = document.getElementById("GD116email").value;
  reg["GD126tuvan"] = document.getElementById("GD126tuvan").value;
  reg["GD126diachi"] = document.getElementById("GD126diachi").value;
  reg["GD126dienthoai"] = document.getElementById("GD126dienthoai").value;
  reg["GD126fax"] = document.getElementById("GD126fax").value;
  reg["GD126email"] = document.getElementById("GD126email");
  reg["GD21thanhphan"] = document.getElementById("GD21thanhphan").value;
  reg["GD23tailieu"] = document.getElementById("GD23tailieu").value;
  reg["GD51giatri"] = document.getElementById("GD51giatri").value;
  reg["GD51thoigian"] = document.getElementById("GD51thoigian").value;
  reg["GD54thoihan"] = document.getElementById("GD54thoihan").value;
  reg["GD71nhathauphu"] = document.getElementById("GD71nhathauphu").value;
  reg["GD72giatri"] = document.getElementById("GD72giatri").value;
  reg["GD74yeucaunhathauphu"] = document.getElementById(
    "GD74yeucaunhathauphu"
  ).value;
  reg["GD14baohiem"] = document.getElementById("GD14baohiem").value;
  reg["GD15thongtincongtruong"] = document.getElementById(
    "GD15thongtincongtruong"
  ).value;
  reg["GD18ngaytiepnhan"] = document.getElementById("GD18ngaytiepnhan").value;
  reg["GD212hoagiai"] = document.getElementById("GD212hoagiai").value;
  reg["GD212giaiquyettranhchap"] = document.getElementById(
    "GD212giaiquyettranhchap"
  ).value;
  reg["GD22khoicong"] = document.getElementById("GD22khoicong").value;
  reg["GD22ngayhoanthanh"] = document.getElementById("GD22ngayhoanthanh").value;
  reg["GD231ngaykhoicong"] = document.getElementById("GD231ngaykhoicong").value;
  reg["GD234bieutien"] = document.getElementById("GD234bieutien").value;
  reg["GD234sotiengiu"] = document.getElementById("GD234sotiengiu").value;
  reg["GD243truonghopkhac"] =
    document.getElementById("GD243truonghopkhac").value;
  reg["GD272vattu"] = document.getElementById("GD272vattu").value;
  reg["GD33hopdong"] = document.getElementById("GD33hopdong").value;
  reg["GD341giahopdong"] = document.getElementById("GD341giahopdong").value;
  reg["GD351tamung"] = document.getElementById("GD351tamung").value;
  reg["GD351thoigiantamung"] = document.getElementById(
    "GD351thoigiantamung"
  ).value;
  reg["GD371ppthanhtoan"] = document.getElementById("GD371ppthanhtoan").value;

  if (document.getElementById("GD38thuecheck").checked == true) {
    reg["GD38thuecheck"] = "1";
  } else {
    reg["GD38thuecheck"] = "0";
  }
  if (document.getElementById("GD38thuenocheck").checked == true) {
    reg["GD38thuenocheck"] = "1";
  } else {
    reg["GD38thuenocheck"] = "0";
  }

  reg["GD38blank"] = document.getElementById("GD38blank").value;
  reg["GD391tiengiulai"] = document.getElementById("GD391tiengiulai").value;
  reg["GD401suahopdong"] = document.getElementById("GD401suahopdong").value;
  reg["GD407dexuatgiaiphap"] = document.getElementById(
    "GD407dexuatgiaiphap"
  ).value;
  reg["GD421mucphat"] = document.getElementById("GD421mucphat").value;

  if (document.getElementById("GD422boithuongcheck").checked == true) {
    reg["GD422boithuongcheck"] = "1";
  } else {
    reg["GD422boithuongcheck"] = "0";
  }
  if (document.getElementById("GD422boithuongnocheck").checked == true) {
    reg["GD422boithuongnocheck"] = "1";
  } else {
    reg["GD422boithuongnocheck"] = "0";
  }

  if (document.getElementById("GD423thuongcheck").checked == true) {
    reg["GD423thuongcheck"] = "1";
  } else {
    reg["GD423thuongcheck"] = "0";
  }
  if (document.getElementById("GD423nothuongcheck").checked == true) {
    reg["GD423nothuongcheck"] = "1";
  } else {
    reg["GD423nothuongcheck"] = "0";
  }

  reg["GD423blank"] = document.getElementById("GD423blank").value;
  reg["GD47thoigianbangiao"] = document.getElementById(
    "GD47thoigianbangiao"
  ).value;
  reg["GD481thoigiannop"] = document.getElementById("GD481thoigiannop").value;
  reg["GD482tiengiulai"] = document.getElementById("GD482tiengiulai").value;
  reg["GDblank"] = document.getElementById("GDblank").value;

  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  reg["makhlcnt"] = makhlcnt.value;
  reg["hinhthuclcnt"] = hinhthuclcnt.value;
  reg["phuongthuclcnt"] = phuongthuclcnt.value;

  var xhr = new XMLHttpRequest();
  xhr.open("POST", "/api/saveehsmt/chuong7", true);
  xhr.onreadystatechange = function () {
    if (xhr.readyState === 4) {
      if (xhr.status === 200) {
        alert("Lưu điều kiện cụ thể của hợp đồng thành công!");
        suachuong7.close();
        //rightButton.disabled = false;
      } else {
        alert("Lưu điều kiện cụ thể của hợp đồng lỗi");
        //saveButton.disabled = false;
      }
    }
  };
  let st = JSON.stringify(reg);
  xhr.send(st);
}

function GD38check() {
  if (document.getElementById("GD38thuecheck").checked == true) {
    document.getElementById("GD38checkcontent").style.display = "flex";
  } else {
    document.getElementById("GD38checkcontent").style.display = "none";
  }
}

function GD422check() {
  if (document.getElementById("GD422boithuongcheck").checked == true) {
    document.getElementById("GD422checkcontent").style.display = "flex";
  } else {
    document.getElementById("GD422checkcontent").style.display = "none";
  }
}

function GD423check() {
  if (document.getElementById("GD423thuongcheck").checked == true) {
    document.getElementById("GD423checkcontent").style.display = "flex";
  } else {
    document.getElementById("GD423checkcontent").style.display = "none";
  }
}

function luusuachuong8() {
  var reg = {};
  if (hd14hopdong.files.length > 0) {
    reg["hd14hopdong"] = hd14hopdong.files[0].name;
  } else {
    reg["hd14hopdong"] = hd14hopdongname.innerHTML;
  }
  if (hd14phuluc.files.length > 0) {
    reg["hd14phuluc"] = hd14phuluc.files[0].name;
  } else {
    reg["hd14phuluc"] = hd14phulucname.innerHTML;
  }

  reg["matbmt"] = document.getElementById("maTBMT1").innerHTML;
  reg["makhlcnt"] = makhlcnt.value;
  reg["hinhthuclcnt"] = hinhthuclcnt.value;
  reg["phuongthuclcnt"] = phuongthuclcnt.value;

  var xhr = new XMLHttpRequest();
  xhr.open("POST", "/api/saveehsmt/chuong8", true);
  xhr.onreadystatechange = function () {
    if (xhr.readyState === 4) {
      if (xhr.status === 200) {
        alert("Lưu chương 8 thành công!");
        suachuong8.close();
        //rightButton.disabled = false;
      } else {
        alert("Lưu chương 8 lỗi");
        //saveButton.disabled = false;
      }
    }
  };
  let st = JSON.stringify(reg);
  xhr.send(st);
}

//edit ngày 30/05/2024

function CD51themmoitable() {
  var tb = document.getElementById("CD51table");
  var rowCount = tb.rows.length;
  var row = tb.insertRow(rowCount);
  var st = rowCount.toString();
  row.insertCell(0).innerHTML = '<p style="text-align: center">' + st + "</p>";
  row.insertCell(1).innerHTML =
    '<textarea id="CD51T' +
    st +
    '1" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text"></textarea>';
  row.insertCell(2).innerHTML =
    '<input id="CD51T' + st + '2" type = "checkbox">';
  row.insertCell(3).innerHTML =
    '<input id="CD51T' + st + '3" type = "checkbox">';
  row.insertCell(4).innerHTML =
    '<input id="CD51T' +
    st +
    '4" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
  row.insertCell(5).innerHTML =
    '<textarea id="CD51T' +
    st +
    '5" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text"></textarea>';
  row.insertCell(6).innerHTML =
    '<p style="text-align: center;"> <i onclick="deltableCD51(' +
    st +
    ')" class = "fa fa-trash" ></i></p>';
}

function deltableCD51(st) {
  var index = parseInt(st) - 1;
  var tb = document.getElementById("CD51table");
  var rowCount = tb.rows.length;
  var tab1data = [];
  var rowdata, i;
  for (i = 1; i < rowCount; i++) {
    rowdata = [];
    for (let j = 1; j < 2; j++) {
      let id = "CD51T" + i.toString() + j.toString();
      rowdata.push(document.getElementById(id).value);
    }
    for (let j = 2; j < 4; j++) {
      let id = "CD51T" + i.toString() + j.toString();
      rowdata.push(document.getElementById(id).value);
    }
    for (let j = 4; j < 6; j++) {
      let id = "CD51T" + i.toString() + j.toString();
      rowdata.push(document.getElementById(id).value);
    }
    tab1data.push(rowdata);
  }

  for (i = 1; i < rowCount; i++) {
    tb.deleteRow(1);
  }

  tab1data.splice(index, 1);
  // alert(tab1data.length);
  for (i = 0; i < tab1data.length; i++) {
    var count = i + 1;
    var row = tb.insertRow(count);
    var st = count.toString();
    row.insertCell(0).innerHTML =
      '<p style="text-align: center">' + st + "</p>";
    row.insertCell(1).innerHTML =
      '<textarea id="CD51T' +
      st +
      '1" value = "' +
      tab1data[i][0] +
      '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text"></textarea>';
    row.insertCell(2).innerHTML =
      '<input id="CD51T' +
      st +
      '2" value = "' +
      tab1data[i][1] +
      '" type = "checkbox">';
    row.insertCell(3).innerHTML =
      '<input id="CD51T' +
      st +
      '3" value = "' +
      tab1data[i][2] +
      '" type = "checkbox">';
    row.insertCell(4).innerHTML =
      '<input id="CD51T' +
      st +
      '4" value = "' +
      tab1data[i][3] +
      '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
    row.insertCell(5).innerHTML =
      '<textarea id="CD51T' +
      st +
      '5" value = "' +
      tab1data[i][4] +
      '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text"></textarea>';
    row.insertCell(6).innerHTML =
      '<p style="text-align: center;"> <i onclick="deltableCD51(' +
      st +
      ')" class = "fa fa-trash" ></i></p>';
  }
}

function DD22athemmoitable() {
  document.getElementById("DD22adialog").showModal();
}

function DD22adialogxacnhan() {
  var x1 = document.getElementById("DD22adialogvitri").value;
  var x2 = document.getElementById("DD22adialogsoluong").value;
  var x4 = document.getElementById("DD22adialoghopdong").value;
  var x3 =
    document.getElementById("DD22adialognam").value +
    " năm, hoặc " +
    x4 +
    " hợp đồng";
  var x5 = document.getElementById("DD22adialogchungchi").value;

  var tb = document.getElementById("DD22atable");
  var rowCount = tb.rows.length;
  var row = tb.insertRow(rowCount);
  var st = rowCount.toString();

  row.insertCell(0).innerHTML = '<p style="text-align: center">' + st + "</p>";
  row.insertCell(1).innerHTML =
    '<input id="DD22aT' +
    st +
    '1" value = "' +
    x1 +
    '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
  row.insertCell(2).innerHTML =
    '<input id="DD22aT' +
    st +
    '2" value = "' +
    x2 +
    '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
  row.insertCell(3).innerHTML =
    '<input id="DD22aT' +
    st +
    '3" value = "' +
    x3 +
    '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
  row.insertCell(4).innerHTML =
    '<input id="DD22aT' +
    st +
    '4" value = "' +
    x5 +
    '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
  row.insertCell(5).innerHTML =
    '<p style="text-align: center; margin-top: 10px;"><i class="fa fa-pencil" aria-hidden="true" style = "margin-inline: 5px;"></i> <i onclick="deltableDD22a(' +
    st +
    ')" class = "fa fa-trash" style = "margin-inline: 5px;"></i></p>';

  document.getElementById("DD22adialog").close();
}

function deltableDD22a(st) {
  var index = parseInt(st) - 1;
  var tb = document.getElementById("DD22atable");
  var rowCount = tb.rows.length;
  var tab2data = [];
  var rowdata, i;
  for (i = 1; i < rowCount; i++) {
    rowdata = [];
    for (let j = 1; j < 5; j++) {
      let id = "DD22aT" + i.toString() + j.toString();
      rowdata.push(document.getElementById(id).value);
    }
    tab2data.push(rowdata);
  }

  for (i = 1; i < rowCount; i++) {
    tb.deleteRow(1);
  }

  tab2data.splice(index, 1);
  // alert(tab1data.length);
  for (i = 0; i < tab2data.length; i++) {
    var count = i + 1;
    var row = tb.insertRow(count);
    var st = count.toString();
    row.insertCell(0).innerHTML =
      '<p style="text-align: center">' + st + "</p>";
    row.insertCell(1).innerHTML =
      '<input id="DD22aT' +
      st +
      '1" value = "' +
      tab2data[i][0] +
      '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
    row.insertCell(2).innerHTML =
      '<input id="DD22aT' +
      st +
      '2" value = "' +
      tab2data[i][1] +
      '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
    row.insertCell(3).innerHTML =
      '<input id="DD22aT' +
      st +
      '3" value = "' +
      tab2data[i][2] +
      '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
    row.insertCell(4).innerHTML =
      '<input id="DD22aT' +
      st +
      '4" value = "' +
      tab2data[i][3] +
      '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
    row.insertCell(5).innerHTML =
      '<p style="text-align: center; margin-top: 10px;"><i class="fa fa-pencil" onclick="changeDD22atabledialog()" aria-hidden="true" style = "margin-inline: 5px;"></i> <i onclick="deltableDD22(' +
      st +
      ')" class = "fa fa-trash" style = "margin-inline: 5px;"></i></p>';
  }
}

function DD22adialogclose() {
  document.getElementById("DD22adialog").close();
}

function DD22bthemmoitable() {
  document.getElementById("DD22bdialog").showModal();
}

function DD22bdialogxacnhan() {
  var x1 = document.getElementById("DD22bdialogthietbi").value;
  var x2 = document.getElementById("DD22bdialogsoluong").value;

  var tb = document.getElementById("DD22btable");
  var rowCount = tb.rows.length;
  var row = tb.insertRow(rowCount);
  var st = rowCount.toString();

  row.insertCell(0).innerHTML = '<p style="text-align: center">' + st + "</p>";
  row.insertCell(1).innerHTML =
    '<input id="DD22bT' +
    st +
    '1" value = "' +
    x1 +
    '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
  row.insertCell(2).innerHTML =
    '<input id="DD22bT' +
    st +
    '2" value = "' +
    x2 +
    '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
  row.insertCell(3).innerHTML =
    '<p style="text-align: center; margin-top: 10px;"><i class="fa fa-pencil" aria-hidden="true" style = "margin-inline: 5px;"></i> <i onclick="deltableDD22b(' +
    st +
    ')" class = "fa fa-trash" style = "margin-inline: 5px;"></i></p>';

  document.getElementById("DD22bdialog").close();
}

function deltableDD22b(st) {
  var index = parseInt(st) - 1;
  var tb = document.getElementById("DD22btable");
  var rowCount = tb.rows.length;
  var tab2data = [];
  var rowdata, i;
  for (i = 1; i < rowCount; i++) {
    rowdata = [];
    for (let j = 1; j < 3; j++) {
      let id = "DD22bT" + i.toString() + j.toString();
      rowdata.push(document.getElementById(id).value);
    }
    tab2data.push(rowdata);
  }

  for (i = 1; i < rowCount; i++) {
    tb.deleteRow(1);
  }

  tab2data.splice(index, 1);
  // alert(tab1data.length);
  for (i = 0; i < tab2data.length; i++) {
    var count = i + 1;
    var row = tb.insertRow(count);
    var st = count.toString();
    row.insertCell(0).innerHTML =
      '<p style="text-align: center">' + st + "</p>";
    row.insertCell(1).innerHTML =
      '<input id="DD22bT' +
      st +
      '1" value = "' +
      tab2data[i][0] +
      '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
    row.insertCell(2).innerHTML =
      '<input id="DD22bT' +
      st +
      '2" value = "' +
      tab2data[i][1] +
      '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
    row.insertCell(3).innerHTML =
      '<p style="text-align: center; margin-top: 10px;"><i class="fa fa-pencil" onclick="changeDD22btabledialog()" aria-hidden="true" style = "margin-inline: 5px;"></i> <i onclick="deltableDD22b(' +
      st +
      ')" class = "fa fa-trash" style = "margin-inline: 5px;"></i></p>';
  }
}

function DD22bdialogclose() {
  document.getElementById("DD22bdialog").close();
}

function ED1Athemmoitable() {
  document.getElementById("ED1Adialog").showModal();
}

function ED1Adialogclose() {
  document.getElementById("ED1Adialog").close();
}

function ED1Adialogxacnhan() {
  var x1 = document.getElementById("ED1Adialogmota").value;
  var x2 = document.getElementById("ED1Adialogkhoiluong").value;
  var x3 = document.getElementById("ED1Adialogdonvitinh").value;

  var tb = document.getElementById("ED1Atable");
  var rowCount = tb.rows.length;
  var row = tb.insertRow(rowCount);
  var st = rowCount.toString();

  row.insertCell(0).innerHTML = '<p style="text-align: center">' + st + "</p>";
  row.insertCell(1).innerHTML =
    '<input id="ED1AT' +
    st +
    '1" value = "' +
    x1 +
    '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
  row.insertCell(2).innerHTML =
    '<input id="ED1AT' +
    st +
    '2" value = "' +
    x2 +
    '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
  row.insertCell(3).innerHTML =
    '<input id="ED1AT' +
    st +
    '3" value = "' +
    x3 +
    '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
  row.insertCell(4).innerHTML =
    '<p style="text-align: center; margin-top: 10px;"><i class="fa fa-pencil" aria-hidden="true" style = "margin-inline: 5px;"></i> <i onclick="deltableED1A(' +
    st +
    ')" class = "fa fa-trash" style = "margin-inline: 5px;"></i></p>';

  document.getElementById("ED1Adialog").close();
}

function deltableED1A(st) {
  var index = parseInt(st) - 1;
  var tb = document.getElementById("ED1Atable");
  var rowCount = tb.rows.length;
  var tab3data = [];
  var rowdata, i;
  for (i = 1; i < rowCount; i++) {
    rowdata = [];
    for (let j = 1; j < 4; j++) {
      let id = "ED1AT" + i.toString() + j.toString();
      rowdata.push(document.getElementById(id).value);
    }
    tab3data.push(rowdata);
  }

  for (i = 1; i < rowCount; i++) {
    tb.deleteRow(1);
  }

  tab3data.splice(index, 1);
  for (i = 0; i < tab3data.length; i++) {
    var count = i + 1;
    var row = tb.insertRow(count);
    var st = count.toString();
    row.insertCell(0).innerHTML =
      '<p style="text-align: center">' + st + "</p>";
    row.insertCell(1).innerHTML =
      '<input id="ED1AT' +
      st +
      '1" value = "' +
      tab3data[i][0] +
      '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
    row.insertCell(2).innerHTML =
      '<input id="ED1AT' +
      st +
      '2" value = "' +
      tab3data[i][1] +
      '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
    row.insertCell(3).innerHTML =
      '<input id="ED1AT' +
      st +
      '3" value = "' +
      tab3data[i][2] +
      '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
    row.insertCell(4).innerHTML =
      '<p style="text-align: center; margin-top: 10px;"><i class="fa fa-pencil" aria-hidden="true" style = "margin-inline: 5px;"></i> <i onclick="deltableED1A(' +
      st +
      ')" class = "fa fa-trash" style = "margin-inline: 5px;"></i></p>';
  }
}

function ED1Ethemmoitable() {
  document.getElementById("ED1Edialog").showModal();
}

function ED1Edialogxacnhan() {
  var x1 = document.getElementById("ED1Edialogdanhmuc").value;
  var x2 = document.getElementById("ED1Edialogdonvitinh").value;
  var x3 = document.getElementById("ED1Edialogkhoiluong").value;

  var tb = document.getElementById("ED1Etable");
  var rowCount = tb.rows.length;
  var row = tb.insertRow(rowCount);
  var st = (rowCount - 1).toString();

  row.insertCell(0).innerHTML = '<p style="text-align: center">' + st + "</p>";
  row.insertCell(1).innerHTML =
    '<input id="ED1ET' +
    st +
    '1" value = "' +
    x1 +
    '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
  row.insertCell(2).innerHTML =
    '<input id="ED1ET' +
    st +
    '2" value = "' +
    x2 +
    '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
  row.insertCell(3).innerHTML =
    '<input id="ED1ET' +
    st +
    '3" value = "' +
    x3 +
    '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
  row.insertCell(4).innerHTML =
    '<p style="text-align: center; margin-top: 10px;"><i class="fa fa-pencil" aria-hidden="true" style = "margin-inline: 5px;"></i> <i onclick="deltableED1E(' +
    st +
    ')" class = "fa fa-trash" style = "margin-inline: 5px;"></i></p>';

  document.getElementById("ED1Edialog").close();
}

function ED1Edialogclose() {
  document.getElementById("ED1Edialog").close();
}

function deltableED1E(st) {
  var index = parseInt(st) - 1;
  var tb = document.getElementById("ED1Etable");
  var rowCount = tb.rows.length;
  var tab5data = [];
  var rowdata, i;
  for (i = 1; i < rowCount - 1; i++) {
    rowdata = [];
    for (let j = 1; j < 4; j++) {
      let id = "ED1ET" + i.toString() + j.toString();
      rowdata.push(document.getElementById(id).value);
    }
    tab5data.push(rowdata);
  }

  for (i = 1; i < rowCount - 1; i++) {
    tb.deleteRow(2);
  }

  tab5data.splice(index, 1);
  for (i = 0; i < tab5data.length; i++) {
    var count = i + 2;
    var row = tb.insertRow(count);
    var st = (count - 1).toString();
    row.insertCell(0).innerHTML =
      '<p style="text-align: center">' + st + "</p>";
    row.insertCell(1).innerHTML =
      '<input id="ED1ET' +
      st +
      '1" value = "' +
      tab5data[i][0] +
      '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
    row.insertCell(2).innerHTML =
      '<input id="ED1ET' +
      st +
      '2" value = "' +
      tab5data[i][1] +
      '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
    row.insertCell(3).innerHTML =
      '<input id="ED1ET' +
      st +
      '3" value = "' +
      tab5data[i][2] +
      '" style="width: 95%; height: 40px; padding-left: 20px; border-radius: 5px; border: 1px solid rgb(197, 197, 197);" type = "text">';
    row.insertCell(4).innerHTML =
      '<p style="text-align: center; margin-top: 10px;"><i class="fa fa-pencil" aria-hidden="true" style = "margin-inline: 5px;"></i> <i onclick="deltableED1E(' +
      st +
      ')" class = "fa fa-trash" style = "margin-inline: 5px;"></i></p>';
  }
}

// sửa ngày 04/06/2024
function changeDD3measures() {
  if (document.getElementById("DD3dat").checked == true) {
    document.getElementById("DD3datkhongdat").style.display = "block";
  } else {
    document.getElementById("DD3datkhongdat").style.display = "none";
  }

  if (document.getElementById("DD3chamdiemcheck").checked == true) {
    document.getElementById("DD3chamdiem").style.display = "block";
  } else {
    document.getElementById("DD3chamdiem").style.display = "none";
  }
}

function DD4changemeasures() {
  if (document.getElementById("DD4giathapnhatcheck").checked == true) {
    document.getElementById("DD4giathapnhat").style.display = "block";
  } else {
    document.getElementById("DD4giathapnhat").style.display = "none";
  }

  if (document.getElementById("DD4giadanhgiacheck").checked == true) {
    document.getElementById("DD4phuongphapgiadanhgia").style.display = "block";
  } else {
    document.getElementById("DD4phuongphapgiadanhgia").style.display = "none";
  }

  if (document.getElementById("DD4phuongphapkethopcheck").checked == true) {
    document.getElementById("DD4phuongphapkethop").style.display = "block";
  } else {
    document.getElementById("DD4phuongphapkethop").style.display = "none";
  }
}

// chỉnh sửa ngày 05/06/2024
function toggleScenarios() {
  value1 = document.getElementById("scenarios").value;
  let TH1 = document.getElementById("truonghop1");
  let TH2 = document.getElementById("truonghop2");
  let TH3 = document.getElementById("truonghop3");

  if (value1 == "TH1") {
    TH1.style.display = "block";
  } else {
    TH1.style.display = "none";
  }

  if (value1 == "TH2") {
    TH2.style.display = "block";
  } else {
    TH2.style.display = "none";
  }

  if (value1 == "TH3") {
    TH3.style.display = "block";
  } else {
    TH3.style.display = "none";
  }
}

function disableradio1() {
  var element1 = document.getElementById("TH1selectvalue1");
  var element2 = document.getElementById("TH1selectvalue2");

  if (document.getElementById("truonghop1radio1").checked == true) {
    element2.classList.add("ele1Style");
    document.getElementById("TH1selectvalue2").style.pointerEvents = "none";
  } else {
    element2.classList.remove("ele1Style");
    document.getElementById("TH1selectvalue2").style.pointerEvents = "auto";
  }

  if (document.getElementById("truonghop1radio2").checked == true) {
    element1.classList.add("ele1Style");
    document.getElementById("TH1selectvalue1").style.pointerEvents = "none";
  } else {
    element1.classList.remove("ele1Style");
    document.getElementById("TH1selectvalue1").style.pointerEvents = "auto";
  }
}

function disableradio2() {
  var element1 = document.getElementById("TH2selectvalue1");
  var element2 = document.getElementById("TH2selectvalue2");

  if (document.getElementById("truonghop2radio1").checked == true) {
    element2.classList.add("ele2Style");
    document.getElementById("TH2selectvalue2").style.pointerEvents = "none";
  } else {
    element2.classList.remove("ele2Style");
    document.getElementById("TH2selectvalue2").style.pointerEvents = "auto";
  }

  if (document.getElementById("truonghop2radio2").checked == true) {
    element1.classList.add("ele2Style");
    document.getElementById("TH2selectvalue1").style.pointerEvents = "none";
  } else {
    element1.classList.remove("ele2Style");
    document.getElementById("TH2selectvalue1").style.pointerEvents = "auto";
  }
}

function truonghop2themdong() {
  let rt1 = parseInt(Math.random() * 10000000);
  rt = rt1.toString();

  let st =
    '<div id="' +
    rt +
    '" style="border-bottom: 1px solid rgb(237, 237, 237); margin: 20px 0px;"> \
            <p>- 02 công trình có: loại kết cấu</p> \
            <input type="text" style="border: 1px solid rgb(198, 198, 198); border-radius: 5px; padding: 5px; height: 40px; width: 90%;"> \
            <p>cấp</p><input type="text" style="border: 1px solid rgb(198, 198, 198); border-radius: 5px; padding: 5px; height: 40px; width: 30%;"> \
            <sup>(12)</sup>, trong đó ít nhất có một công trình có trị giá là (V1) <input type="text" placeholder="-- VND --" style="border: 1px solid rgb(198, 198, 198); border-radius: 5px; padding: 5px; height: 40px; width: 30%;"> <sup>(13)</sup> VND và tổng giá trị tất cả các công trình ≥ <strong>VND (X1)</strong>, với tư cách là nhà thầu chính (độc lập hoặc thành viên liên danh) nhà thầu quản lý hoặc nhà thầu phụ trong đó X1= 2 x V1. Trường hợp nhà thầu đã hoàn thành toàn bộ hoặc phần lớn <sup>(11)</sup> 01 công trình đáp ứng yêu cầu về loại kết cấu, cấp công trình và có giá trị ≥ X1 thì được coi là đáp ứng.\
            <div style="display: flex; justify-content: flex-end; margin: 10px 0px;"> \
            <button onclick="xoatruonghop2id(' +
    rt +
    ')" style="border: 1px solid red; border-radius: 5px; background-color: red; color: white;">Xóa</button> \
            </div> \
            </div>';
  document.getElementById("truonghop2div").innerHTML += st;
}

function xoatruonghop2id(rt) {
  var mynode = document.getElementById(rt);
  mynode.parentNode.removeChild(mynode);
}

function truonghop2themdong1() {
  let rt1 = parseInt(Math.random() * 10000000);
  rt = rt1.toString();

  let st =
    '<div id="' +
    rt +
    '" style="border-bottom: 1px solid rgb(237, 237, 237); margin: 20px 0px;"> \
            <p>- 02 công trình có: loại kết cấu</p> \
            <input type="text" style="border: 1px solid rgb(198, 198, 198); border-radius: 5px; padding: 5px; height: 40px; width: 90%;"> \
            <p>cấp</p><input type="text" style="border: 1px solid rgb(198, 198, 198); border-radius: 5px; padding: 5px; height: 40px; width: 30%;"> \
            <sup>(12)</sup>, có giá trị là (V1) <input type="text" placeholder="-- VND --" style="border: 1px solid rgb(198, 198, 198); border-radius: 5px; padding: 5px; height: 40px; width: 30%;"> VND với tư cách là nhà thầu chính (độc lập hoặc thành viên liên danh), nhà thầu quản lý hoặc nhà thầu phụ \
            <div style="display: flex; justify-content: flex-end; margin: 10px 0px;"> \
            <button onclick="xoatruonghop2option(' +
    rt +
    ')" style="border: 1px solid red; border-radius: 5px; background-color: red; color: white;">Xóa</button> \
            </div>\
            </div>';

  document.getElementById("truonghop2div2").innerHTML += st;
}

function xoatruonghop2option(rt) {
  var mynode = document.getElementById(rt);
  mynode.parentNode.removeChild(mynode);
}

function truonghop3themdong() {
  let rt1 = parseInt(Math.random() * 10000000);
  rt = rt1.toString();

  let st =
    '<div id="' +
    rt +
    '" style="border-bottom: 1px solid rgb(237, 237, 237); margin: 20px 0px;"> \
            <p>- 01 hạng mục có tính chất tương tự với hạng mục</p> \
            <input type="text" style="border: 1px solid rgb(198, 198, 198); border-radius: 5px; padding: 5px; height: 40px; width: 90%;"> \
            <p style="margin-top: 10px;">, có giá trị là (V1) <input type="text" placeholder="-- VND --" style="border: 1px solid rgb(198, 198, 198); border-radius: 5px; padding: 5px; height: 40px; width: 30%;"> <sup>(13)</sup> VND với tư cách là nhà thầu chính (độc lập hoặc thành viên liên danh), nhà thầu quản lý hoặc nhà thầu phụ</p> \
            <div style="display: flex; justify-content: flex-end; margin: 10px 0px;"> \
            <button id onclick="xoatruonghop3option(' +
    rt +
    ')" style="border: 1px solid red; border-radius: 5px; background-color: red; color: white;">Xóa</button> \
            </div>\
            </div>';

  document.getElementById("truonghop3div").innerHTML += st;
}

function xoatruonghop3option(rt) {
  var mynode = document.getElementById(rt);
  mynode.parentNode.removeChild(mynode);
}

function DD22aradiochange() {
  if (document.getElementById("DD22anhansucheck").checked == true) {
    document.getElementById("DD22aviewcontent").style.display = "block";
  } else {
    document.getElementById("DD22aviewcontent").style.display = "none";
  }
}

function DD22bradiochange() {
  if (document.getElementById("DD22bnhansucheck").checked == true) {
    document.getElementById("DD22bviewcontent").style.display = "block";
  } else {
    document.getElementById("DD22bviewcontent").style.display = "none";
  }
}
